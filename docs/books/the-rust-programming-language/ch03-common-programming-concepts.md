# ç¬¬ä¸‰ç« ï¼šé€šç”¨ç¼–ç¨‹æ¦‚å¿µ

æœ¬ç« å‡ ä¹æ¶µç›–äº†æ¯ç§ç¼–ç¨‹è¯­è¨€éƒ½å‡ºç°çš„æ¦‚å¿µï¼Œå¹¶ä»‹ç»å®ƒä»¬åœ¨ Rust ä¸­çš„å·¥ä½œåŸç†ã€‚è®¸å¤šç¼–ç¨‹è¯­è¨€çš„æ ¸å¿ƒéƒ¨åˆ†éƒ½æœ‰å¾ˆå¤šå…±åŒç‚¹ã€‚æœ¬ç« æåˆ°çš„æ¦‚å¿µéƒ½ä¸æ˜¯ Rust ç‰¹æœ‰çš„ï¼Œæˆ‘ä»¬å°†åœ¨ Rust çš„èƒŒæ™¯ä¸‹è®¨è®ºå®ƒä»¬ï¼Œå¹¶è§£é‡Šä½¿ç”¨è¿™äº›æ¦‚å¿µçš„çº¦å®šã€‚

æ€»è€Œè¨€ä¹‹ï¼Œä½ å°†å­¦ä¹ åˆ°å˜é‡ã€åŸºæœ¬ç±»å‹ã€å‡½æ•°ã€æ³¨é‡Šå’Œæ§åˆ¶æµã€‚è¿™äº›åŸºç¡€çŸ¥è¯†å‡ ä¹åœ¨æ¯ä¸ª Rust ç¨‹åºä¸­éƒ½ä¼šé‡åˆ°ï¼Œåº”å°½æ—©æ¥è§¦è¿™äº›å†…å®¹ï¼Œä»æ ¸å¿ƒçŸ¥è¯†å­¦èµ·ã€‚

## 1. å˜é‡å’Œå¯å˜æ€§

å¦‚[â€œä½¿ç”¨å˜é‡å­˜å‚¨å€¼â€](https://rustwiki.org/zh-CN/book/ch02-00-guessing-game-tutorial.html#ä½¿ç”¨å˜é‡å­˜å‚¨å€¼)ç« èŠ‚æ‰€è¿°ï¼Œé»˜è®¤æƒ…å†µä¸‹å˜é‡æ˜¯ **ä¸å¯å˜çš„**ï¼ˆ*immutable*ï¼‰ã€‚è¿™æ˜¯ Rust ä¼—å¤šç²¾å¦™ä¹‹å¤„çš„å…¶ä¸­ä¸€ä¸ªï¼Œè¿™äº›ç‰¹æ€§è®©ä½ å……åˆ†åˆ©ç”¨ Rust æä¾›çš„å®‰å…¨æ€§å’Œç®€å•å¹¶å‘æ€§çš„æ–¹å¼æ¥ç¼–å†™ä»£ç ã€‚ä¸è¿‡ä½ ä¹Ÿå¯ä»¥é€‰æ‹©è®©å˜é‡æ˜¯ **å¯å˜çš„**ï¼ˆ*mutable*ï¼‰ã€‚è®©æˆ‘ä»¬æ¢è®¨ä¸€ä¸‹ Rust å¦‚ä½•åŠä¸ºä»€ä¹ˆé¼“åŠ±ä½ é€‰ç”¨ä¸å¯å˜æ€§ï¼Œä»¥åŠä¸ºä»€ä¹ˆæœ‰æ—¶ä½ å¯èƒ½ä¸é€‰ç”¨ã€‚

å½“å˜é‡ä¸å¯å˜æ—¶ï¼Œè¿™æ„å‘³ç€ä¸€æ—¦ä¸€ä¸ªå€¼ç»‘å®šåˆ°ä¸€ä¸ªå˜é‡ååï¼Œå°±ä¸èƒ½æ›´æ”¹è¯¥å€¼äº†ã€‚ä¸ºäº†è¯´æ˜ï¼Œæˆ‘ä»¬åœ¨ *projects* ç›®å½•ä¸‹ä½¿ç”¨ `cargo new variables` æ¥åˆ›å»ºä¸€ä¸ªåä¸º *variables* æ–°é¡¹ç›®ã€‚

ç„¶ååœ¨æ–°å»ºçš„ *variables* ç›®å½•ä¸‹ï¼Œæ‰“å¼€ *src/main.rs* å¹¶å°†ä»£ç æ›¿æ¢æˆä»¥ä¸‹ä»£ç ã€‚è¿™æ®µä»£ç è¿˜ä¸èƒ½ç¼–è¯‘ï¼Œæˆ‘ä»¬å…ˆæ£€æŸ¥ä¸å¯å˜é”™è¯¯ï¼ˆimmutability errorï¼‰ï¼š

```rust title="src/main.rs" linenums="1"
fn main() {
    let x = 5;
    println!("The value of x is: {}", x);
    x = 6;
    println!("The value of x is: {}", x);
}
```

ä¿å­˜æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨ `cargo run` è¿è¡Œç¨‹åºã€‚ä½ å°†ä¼šæ”¶åˆ°ä¸€æ¡é”™è¯¯ä¿¡æ¯ï¼Œè¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š

```console
$ cargo run
   Compiling variables v0.1.0 (file:///projects/variables)
error[E0384]: cannot assign twice to immutable variable `x`
 --> src/main.rs:4:5
  |
2 |     let x = 5;
  |         -
  |         |
  |         first assignment to `x`
  |         help: consider making this binding mutable: `mut x`
3 |     println!("The value of x is: {}", x);
4 |     x = 6;
  |     ^^^^^ cannot assign twice to immutable variable

For more information about this error, try `rustc --explain E0384`.
error: could not compile `variables` due to previous error
```

è¿™ä¸ªä¾‹å­å±•ç¤ºäº†ç¼–è¯‘å™¨å¦‚ä½•å¸®åŠ©ä½ æŸ¥æ‰¾ç¨‹åºä¸­çš„é”™è¯¯ã€‚ç¼–è¯‘å™¨é”™è¯¯å¯èƒ½ä»¤äººæ²®ä¸§ï¼Œä½†å®ƒä»¬ä¹Ÿåªæ˜¯è¡¨æ˜ä½ çš„ç¨‹åºåšä½ æƒ³åšçš„äº‹æƒ…å¹¶ä¸å®‰å…¨ï¼›å¹¶ **ä¸** æ„å‘³ç€ä½ ä¸æ˜¯ä¸€ä¸ªå¥½å¼€å‘è€…ï¼æœ‰ç»éªŒçš„ Rustaceanï¼ˆRust å¼€å‘è€…ï¼‰ ä¾ç„¶ä¼šé‡åˆ°ç¼–è¯‘é”™è¯¯ã€‚

ä¸Šé¢çš„é”™è¯¯æŒ‡å‡ºé”™è¯¯çš„åŸå› æ˜¯ cannot assign twice to immutable variable `x`ï¼ˆä¸èƒ½å¯¹ä¸å¯å˜å˜é‡äºŒæ¬¡èµ‹å€¼ï¼‰ï¼Œå› ä¸ºæˆ‘ä»¬å°è¯•ç»™ä¸å¯å˜çš„ `x` å˜é‡èµ‹å€¼ä¸ºç¬¬äºŒä¸ªå€¼ã€‚

å½“æˆ‘ä»¬å°è¯•æ”¹å˜ä¸€ä¸ªå‰é¢æŒ‡å®šä¸ºä¸å¯å˜çš„å€¼æ—¶æˆ‘ä»¬ä¼šå¾—åˆ°ç¼–è¯‘æœŸé”™è¯¯ï¼Œè¿™ç‚¹å¾ˆé‡è¦ï¼Œå› ä¸ºè¿™ç§æƒ…å†µå¾ˆå¯èƒ½å¯¼è‡´ bugã€‚å¦‚æœæˆ‘ä»¬ä»£ç çš„ä¸€éƒ¨åˆ†å‡è®¾æŸä¸ªå€¼æ°¸è¿œä¸ä¼šæ›´æ”¹ï¼Œè€Œä»£ç çš„å¦ä¸€éƒ¨åˆ†æ›´æ”¹äº†è¯¥å€¼ï¼Œé‚£å¾ˆå¯èƒ½ç¬¬ä¸€éƒ¨åˆ†ä»£ç ä»¥ä¸å¯æ„æ–™çš„æ–¹å¼è¿è¡Œã€‚è¿™ä¸ª bug çš„æ ¹æºåœ¨å®é™…å¼€å‘ä¸­å¯èƒ½å¾ˆéš¾è¿½è¸ªï¼Œç‰¹åˆ«æ˜¯ç¬¬äºŒéƒ¨åˆ†ä»£ç åªæ˜¯ **å¶å°”** å˜æ›´äº†åŸæ¥çš„å€¼ã€‚Rust ç¼–è¯‘å™¨ä¿è¯äº†å½“æˆ‘ä»¬å£°æ˜äº†ä¸€ä¸ªå€¼ä¸ä¼šæ”¹å˜æ—¶ï¼Œé‚£å®ƒå°±çœŸçš„ä¸å¯æ”¹å˜ï¼Œæ‰€ä»¥ä½ ä¸å¿…äº²è‡ªè·Ÿè¸ªè¿™ä¸ªå€¼ã€‚è¿™å¯ä»¥ä½¿å¾—ä»£ç æ›´å®¹æ˜“ç†è§£ã€‚

ä½†å¯å˜æ€§æœ‰æ—¶ä¹Ÿç›¸å½“é‡è¦ï¼Œå¯ä½¿ä»£ç æ›´æ–¹ä¾¿ç¼–å†™ã€‚å˜é‡åªæ˜¯é»˜è®¤ä¸å¯å˜çš„ï¼›åƒç¬¬ 2 ç« æ‰€åšçš„é‚£æ ·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨å˜é‡åå‰åŠ ä¸Š `mut` ä½¿å¾—å®ƒä»¬å¯å˜ã€‚å¢åŠ  `mut` çš„æ“ä½œè¿˜å‘ä»¥åçš„è¯»ä»£ç çš„äººä¼ è¾¾äº†ä»£ç çš„å…¶ä»–éƒ¨åˆ†å°†ä¼šæ”¹å˜è¿™ä¸ªå˜é‡å€¼ã€‚

ä¾‹å¦‚å°† *src/main.rs* æ”¹ä¸ºä»¥ä¸‹å†…å®¹ï¼š

```rust title="src/main.rs" linenums="1" hl_lines="2 4"
fn main() {
    let mut x = 5;
    println!("The value of x is: {}", x);
    x = 6;
    println!("The value of x is: {}", x);
}
```

è¿è¡Œç¨‹åºå°†å¾—åˆ°ä¸‹é¢ç»“æœï¼š

```console
$ cargo run
   Compiling variables v0.1.0 (file:///projects/variables)
    Finished dev [unoptimized + debuginfo] target(s) in 0.30s
     Running `target/debug/variables`
The value of x is: 5
The value of x is: 6
```

åŠ ä¸Š `mut` åï¼Œæˆ‘ä»¬å°±å¯ä»¥å°† `x` ç»‘å®šçš„å€¼ä» `5` æ”¹æˆ `6`ã€‚é™¤äº†é¢„é˜² bug å¤–ï¼Œè¿˜æœ‰å¾ˆå¤šæƒè¡¡è¦å–èˆã€‚ä¾‹å¦‚ï¼Œåœ¨ä½¿ç”¨å¤§å‹æ•°æ®ç»“æ„çš„æƒ…å½¢ä¸‹ï¼Œåœ¨åŒä¸€ä½ç½®æ›´æ”¹å®ä¾‹å¯èƒ½æ¯”å¤åˆ¶å¹¶è¿”å›æ–°åˆ†é…çš„å®ä¾‹è¦æ›´å¿«ã€‚ä½¿ç”¨è¾ƒå°çš„æ•°æ®ç»“æ„æ—¶ï¼Œé€šå¸¸åˆ›å»ºæ–°çš„å®ä¾‹å¹¶ä»¥æ›´å…·å‡½æ•°å¼ç¼–ç¨‹çš„é£æ ¼æ¥ç¼–å†™ç¨‹åºï¼Œå¯èƒ½ä¼šæ›´å®¹æ˜“ç†è§£ï¼Œæ‰€ä»¥å€¼å¾—ä»¥è¾ƒä½çš„æ€§èƒ½å¼€é”€æ¥ç¡®ä¿ä»£ç æ¸…æ™°ã€‚

### 1.1 å¸¸é‡

ä¸ä¸å¯å˜å˜é‡ç±»ä¼¼ï¼Œ**å¸¸é‡**ï¼ˆ*constant*ï¼‰æ˜¯ç»‘å®šåˆ°ä¸€ä¸ªå¸¸é‡åä¸”ä¸å…è®¸æ›´æ”¹çš„å€¼ï¼Œä½†æ˜¯å¸¸é‡å’Œå˜é‡ä¹‹é—´å­˜åœ¨ä¸€äº›å·®å¼‚ã€‚

é¦–å…ˆï¼Œå¸¸é‡ä¸å…è®¸ä½¿ç”¨ `mut`ã€‚å¸¸é‡ä¸ä»…ä»…é»˜è®¤ä¸å¯å˜ï¼Œè€Œä¸”è‡ªå§‹è‡³ç»ˆä¸å¯å˜ã€‚å¸¸é‡ä½¿ç”¨ `const` å…³é”®å­—è€Œä¸æ˜¯ `let` å…³é”®å­—æ¥å£°æ˜ï¼Œå¹¶ä¸”å€¼çš„ç±»å‹ **å¿…é¡»** æ³¨æ˜ã€‚æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€èŠ‚[â€œæ•°æ®ç±»å‹â€](https://rustwiki.org/zh-CN/book/ch03-02-data-types.html#æ•°æ®ç±»å‹)ä¸­ä»‹ç»ç±»å‹å’Œç±»å‹æ ‡æ³¨ï¼Œç°åœ¨æš‚æ—¶ä¸éœ€å…³å¿ƒç»†èŠ‚ã€‚åªéœ€çŸ¥é“ä½ å¿…é¡»å§‹ç»ˆå¯¹ç±»å‹è¿›è¡Œæ³¨æ˜ã€‚

å¸¸é‡å¯ä»¥åœ¨ä»»æ„ä½œç”¨åŸŸå†…å£°æ˜ï¼ŒåŒ…æ‹¬å…¨å±€ä½œç”¨åŸŸï¼Œè¿™å¯¹äºä»£ç ä¸­å¾ˆå¤šéƒ¨åˆ†éƒ½éœ€è¦çŸ¥é“ä¸€ä¸ªå€¼çš„æƒ…å†µç‰¹åˆ«æœ‰ç”¨ã€‚

æœ€åä¸€ä¸ªä¸åŒç‚¹æ˜¯å¸¸é‡åªèƒ½è®¾ç½®ä¸ºå¸¸é‡è¡¨è¾¾å¼ï¼Œè€Œä¸èƒ½æ˜¯å‡½æ•°è°ƒç”¨çš„ç»“æœæˆ–æ˜¯åªèƒ½åœ¨è¿è¡Œæ—¶è®¡ç®—å¾—åˆ°çš„å€¼ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå¸¸é‡å£°æ˜çš„ä¾‹å­ï¼š

```rust
const THREE_HOURS_IN_SECONDS: u32 = 60 * 60 * 3;
```

è¿™ä¸ªå¸¸é‡åä¸º `THREE_HOURS_IN_SECONDS`ï¼Œå€¼è®¾ç½®ä¸º 60ï¼ˆä¸€åˆ†é’Ÿå†…çš„ç§’æ•°ï¼‰ä¹˜ä»¥ 60ï¼ˆä¸€å°æ—¶å†…åˆ†é’Ÿæ•°ï¼‰å†ä¹˜ä»¥ 3ï¼ˆæˆ‘ä»¬åœ¨è¿™ç¨‹åºï¼‰ã€‚Rust å¸¸é‡çš„å‘½åçº¦å®šæ˜¯å…¨éƒ¨å­—æ¯éƒ½ä½¿ç”¨å¤§å†™ï¼Œå¹¶ä½¿ç”¨ä¸‹åˆ’çº¿åˆ†éš”å•è¯ã€‚ç¼–è¯‘å™¨èƒ½å¤Ÿåœ¨ç¼–è¯‘æ—¶è®¡ç®—ä¸€äº›æœ‰é™çš„æ“ä½œï¼Œè¿™è®©æˆ‘ä»¬å¯ä»¥é€‰æ‹©ä»¥æ›´å®¹æ˜“ç†è§£å’ŒéªŒè¯çš„æ–¹å¼å†™å‡ºè¿™ä¸ªå€¼ï¼Œè€Œä¸æ˜¯å°†æ­¤å¸¸é‡è®¾ç½®ä¸ºå€¼ 10,800ã€‚æœ‰å…³åœ¨å£°æ˜å¸¸é‡æ—¶å¯ä»¥ä½¿ç”¨å“ªäº›æ“ä½œçš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…[ã€ŠRust å‚è€ƒæ‰‹å†Œã€‹ä¸­å…³äºå¸¸é‡è®¡ç®—çš„ç« èŠ‚](https://rustwiki.org/zh-CN/reference/const_eval.html)ã€‚

åœ¨å£°æ˜çš„ä½œç”¨åŸŸå†…ï¼Œå¸¸é‡åœ¨ç¨‹åºè¿è¡Œçš„æ•´ä¸ªè¿‡ç¨‹ä¸­éƒ½æœ‰æ•ˆã€‚å¯¹äºåº”ç”¨ç¨‹åºåŸŸä¸­ç¨‹åºçš„å¤šä¸ªéƒ¨åˆ†å¯èƒ½éƒ½éœ€è¦çŸ¥é“çš„å€¼çš„æ—¶å€™ï¼Œå¸¸é‡æ˜¯ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„é€‰æ‹©ï¼Œä¾‹å¦‚æ¸¸æˆä¸­å…è®¸ç©å®¶èµšå–çš„æœ€é«˜åˆ†æˆ–å…‰é€Ÿã€‚

å°†æ•´ä¸ªç¨‹åºä¸­ç”¨åˆ°çš„ç¡¬ç¼–ç ï¼ˆhardcodeï¼‰å€¼å‘½åä¸ºå¸¸é‡ï¼Œå¯¹äºå°†è¯¥å€¼çš„å«ä¹‰ä¼ è¾¾ç»™ä»£ç çš„æœªæ¥ç»´æŠ¤è€…å¾ˆæœ‰ç”¨ã€‚å¦‚æœå°†æ¥éœ€è¦æ›´æ”¹ç¡¬ç¼–ç çš„å€¼ï¼Œåˆ™åªéœ€è¦åœ¨ä»£ç ä¸­æ”¹åŠ¨ä¸€å¤„å°±å¯ä»¥äº†ã€‚

### 1.2 é®è”½

æ­£å¦‚ä½ åœ¨ç¬¬ 2 ç« [â€œçŒœæ•°å­—æ¸¸æˆâ€](https://rustwiki.org/zh-CN/book/ch02-00-guessing-game-tutorial.html#æ¯”è¾ƒçŒœæµ‹çš„æ•°å­—å’Œç§˜å¯†æ•°å­—)ç« èŠ‚ä¸­æ‰€çœ‹åˆ°çš„ï¼Œä½ å¯ä»¥å£°æ˜å’Œå‰é¢å˜é‡å…·æœ‰ç›¸åŒåç§°çš„æ–°å˜é‡ã€‚Rustacean è¯´è¿™ä¸ªæ˜¯ç¬¬ä¸€ä¸ªå˜é‡è¢«ç¬¬äºŒä¸ªå˜é‡ **é®è”½**ï¼ˆ*shadow*ï¼‰ï¼Œè¿™æ„å‘³ç€å½“æˆ‘ä»¬ä½¿ç”¨å˜é‡æ—¶æˆ‘ä»¬çœ‹åˆ°çš„ä¼šæ˜¯ç¬¬äºŒä¸ªå˜é‡çš„å€¼ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ç›¸åŒçš„å˜é‡åå¹¶é‡å¤ä½¿ç”¨ `let` å…³é”®å­—æ¥é®è”½å˜é‡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

æ–‡ä»¶åï¼šsrc/main.rs

```rust title="src/main.rs" linenums="1" hl_lines="3 6-7"
fn main() {
    let x = 5;
    let x = x + 1;

    {
        let x = x * 2;
        println!("The value of x in the inner scope is: {}", x);
    }

    println!("The value of x is: {}", x);
}
```

è¿™ä¸ªç¨‹åºé¦–å…ˆå°†æ•°å€¼ `5` ç»‘å®šåˆ° `x`ã€‚ç„¶åé€šè¿‡é‡å¤ä½¿ç”¨ `let x =` æ¥é®è”½ä¹‹å‰çš„ `x`ï¼Œå¹¶å–åŸæ¥çš„å€¼åŠ ä¸Š `1`ï¼Œæ‰€ä»¥ `x` çš„å€¼å˜æˆäº† `6`ã€‚åœ¨å†…éƒ¨ä½œç”¨åŸŸå†…ï¼Œç¬¬ä¸‰ä¸ª `let` è¯­å¥åŒæ ·é®è”½å‰é¢çš„ `x`ï¼Œå–ä¹‹å‰çš„å€¼å¹¶ä¹˜ä¸Š `2`ï¼Œå¾—åˆ°çš„ `x` å€¼ä¸º `12`ã€‚å½“è¯¥ä½œç”¨åŸŸç»“æŸæ—¶ï¼Œå†…éƒ¨é®è”½ç»“æŸå¹¶ä¸” `x` æ¢å¤æˆ `6`ã€‚å½“è¿è¡Œæ­¤ç¨‹åºï¼Œå°†è¾“å‡ºä»¥ä¸‹å†…å®¹ï¼š

```console
$ cargo run
   Compiling variables v0.1.0 (file:///projects/variables)
    Finished dev [unoptimized + debuginfo] target(s) in 0.31s
     Running `target/debug/variables`
The value of x in the inner scope is: 12
The value of x is: 6
```

é®è”½å’Œå°†å˜é‡æ ‡è®°ä¸º `mut` çš„æ–¹å¼ä¸åŒï¼Œå› ä¸ºé™¤éæˆ‘ä»¬å†æ¬¡ä½¿ç”¨ `let` å…³é”®å­—ï¼Œå¦åˆ™è‹¥æ˜¯æˆ‘ä»¬ä¸å°å¿ƒå°è¯•é‡æ–°èµ‹å€¼ç»™è¿™ä¸ªå˜é‡ï¼Œæˆ‘ä»¬å°†å¾—åˆ°ä¸€ä¸ªç¼–è¯‘é”™è¯¯ã€‚é€šè¿‡ä½¿ç”¨ `let`ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ä¸€ä¸ªå€¼è¿›è¡Œä¸€äº›è½¬æ¢ï¼Œä½†åœ¨è¿™äº›è½¬æ¢å®Œæˆåï¼Œå˜é‡å°†æ˜¯ä¸å¯å˜çš„ã€‚

`mut` å’Œé®è”½ä¹‹é—´çš„å¦ä¸€ä¸ªåŒºåˆ«æ˜¯ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨å†æ¬¡ä½¿ç”¨ `let` å…³é”®å­—æ—¶æœ‰æ•ˆåœ°åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å˜é‡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ”¹å˜å€¼çš„ç±»å‹ï¼Œä½†é‡å¤ä½¿ç”¨ç›¸åŒçš„åç§°ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬ç¨‹åºè¦æ±‚ç”¨æˆ·è¾“å…¥ç©ºæ ¼å­—ç¬¦æ¥æ˜¾ç¤ºä»–ä»¬æƒ³è¦çš„ç©ºæ ¼æ•°ç›®ï¼Œä½†æˆ‘ä»¬å®é™…ä¸Šæƒ³è¦å°†è¯¥è¾“å…¥å­˜å‚¨ä¸ºä¸€ä¸ªæ•°å­—ï¼š

```rust linenums="1"
let spaces = "   ";
let spaces = spaces.len();
```

ç¬¬ä¸€ä¸ª `spaces` å˜é‡æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹ï¼Œç¬¬äºŒä¸ª `spaces` å˜é‡æ˜¯ä¸€ä¸ªæ•°å­—ç±»å‹ã€‚æ‰€ä»¥å˜é‡é®è”½å¯ä»¥è®©æˆ‘ä»¬ä¸å¿…ç»™å‡ºä¸åŒçš„åç§°ï¼Œå¦‚ `spaces_str` å’Œ `spaces_num`ï¼Œç›¸åæˆ‘ä»¬å¯ä»¥é‡å¤ä½¿ç”¨æ›´ç®€å•çš„ `spaces` å˜é‡åã€‚ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬å¯¹æ­¤å°è¯•ä½¿ç”¨ `mut`ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œæˆ‘ä»¬å°†å¾—åˆ°ä¸€ä¸ªç¼–è¯‘æœŸé”™è¯¯ï¼š

```rust
let mut spaces = "   ";
spaces = spaces.len();
```

è¯¥é”™è¯¯è¡¨æ˜æˆ‘ä»¬ä¸å…è®¸æ›´æ”¹å˜é‡çš„ç±»å‹ï¼š

```console
$ cargo run
   Compiling variables v0.1.0 (file:///projects/variables)
error[E0308]: mismatched types
 --> src/main.rs:3:14
  |
2 |     let mut spaces = "   ";
  |                      ----- expected due to this value
3 |     spaces = spaces.len();
  |              ^^^^^^^^^^^^ expected `&str`, found `usize`

For more information about this error, try `rustc --explain E0308`.
error: could not compile `variables` due to previous error
```

ç°åœ¨æˆ‘ä»¬å·²ç»æ¢è®¨äº†å˜é‡æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å­¦ä¹ æ›´å¤šçš„æ•°æ®ç±»å‹ã€‚

## 2. æ•°æ®ç±»å‹

Rust çš„æ¯ä¸ªå€¼éƒ½æœ‰ç¡®åˆ‡çš„ **æ•°æ®ç±»å‹**ï¼ˆ*data type*ï¼‰ï¼Œè¯¥ç±»å‹å‘Šè¯‰ Rust æ•°æ®æ˜¯è¢«æŒ‡å®šæˆå“ªç±»æ•°æ®ï¼Œä»è€Œè®© Rust çŸ¥é“å¦‚ä½•ä½¿ç”¨è¯¥æ•°æ®ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸¤ç§æ•°æ®ç±»å‹ï¼š**æ ‡é‡ç±»å‹** å’Œ **å¤åˆç±»å‹**ã€‚

è¯·è®°ä½ Rust æ˜¯ä¸€ç§ **é™æ€ç±»å‹**ï¼ˆ*statically typed*ï¼‰çš„è¯­è¨€ï¼Œè¿™æ„å‘³ç€å®ƒå¿…é¡»åœ¨ç¼–è¯‘æœŸçŸ¥é“æ‰€æœ‰å˜é‡çš„ç±»å‹ã€‚ç¼–è¯‘å™¨é€šå¸¸å¯ä»¥æ ¹æ®å€¼å’Œä½¿ç”¨æ–¹å¼æ¨å¯¼å‡ºæˆ‘ä»¬æƒ³è¦ä½¿ç”¨çš„ç±»å‹ã€‚åœ¨ç±»å‹å¯èƒ½æ˜¯å¤šç§æƒ…å†µæ—¶ï¼Œä¾‹å¦‚åœ¨ç¬¬ 2 ç« [â€œæ¯”è¾ƒçŒœæµ‹çš„æ•°å­—å’Œç§˜å¯†æ•°å­—â€](https://rustwiki.org/zh-CN/book/ch02-00-guessing-game-tutorial.html#æ¯”è¾ƒçŒœæµ‹çš„æ•°å­—å’Œç§˜å¯†æ•°å­—)ä¸­å½“æˆ‘ä»¬ä½¿ç”¨ `parse` å°† `String` è½¬æ¢æˆæ•°å€¼ç±»å‹æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»åŠ ä¸Šä¸€ä¸ªç±»å‹æ ‡æ³¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```rust
let guess: u32 = "42".parse().expect("Not a number!");
```

å¦‚æœæˆ‘ä»¬åœ¨è¿™é‡Œä¸æ·»åŠ ç±»å‹æ ‡æ³¨çš„è¯ï¼ŒRust å°†æ˜¾ç¤ºä»¥ä¸‹é”™è¯¯ï¼Œæ„æ€æ˜¯ç¼–è¯‘å™¨éœ€è¦æˆ‘ä»¬æä¾›æ›´å¤šä¿¡æ¯æ¥ç¡®å®šæˆ‘ä»¬åˆ°åº•æƒ³ç”¨ä»€ä¹ˆç±»å‹ï¼š

```console
$ cargo build
   Compiling no_type_annotations v0.1.0 (file:///projects/no_type_annotations)
error[E0282]: type annotations needed
 --> src/main.rs:2:9
  |
2 |     let guess = "42".parse().expect("Not a number!");
  |         ^^^^^ consider giving `guess` a type

For more information about this error, try `rustc --explain E0282`.
error: could not compile `no_type_annotations` due to previous error
```

å¯¹äºå…¶ä»–æ•°æ®ç±»å‹ï¼Œä½ å°†çœ‹åˆ°ä¸åŒçš„ç±»å‹æ ‡æ³¨ã€‚

### 2.1 æ ‡é‡ç±»å‹

**æ ‡é‡**ï¼ˆ*scalar*ï¼‰ç±»å‹è¡¨ç¤ºå•ä¸ªå€¼ã€‚Rust æœ‰ 4 ä¸ªåŸºæœ¬çš„æ ‡é‡ç±»å‹ï¼š**æ•´å‹**ã€**æµ®ç‚¹å‹**ã€**å¸ƒå°”å‹**å’Œ**å­—ç¬¦**ã€‚ä½ å¯èƒ½ä»å…¶ä»–è¯­è¨€äº†è§£è¿‡è¿™äº›ç±»å‹ã€‚ä¸‹é¢æˆ‘ä»¬æ·±å…¥äº†è§£å®ƒä»¬åœ¨ Rust ä¸­çš„ç”¨æ³•ã€‚

#### 2.1.1 æ•´æ•°ç±»å‹

**æ•´æ•°**ï¼ˆ*integer*ï¼‰æ˜¯æ²¡æœ‰å°æ•°éƒ¨åˆ†çš„æ•°å­—ã€‚æˆ‘ä»¬åœ¨ç¬¬ 2 ç« ä½¿ç”¨è¿‡ä¸€ä¸ªæ•´æ•°ç±»å‹ï¼ˆæ•´å‹ï¼‰ï¼Œå³ `u32` ç±»å‹ã€‚æ­¤ç±»å‹å£°æ˜è¡¨æ˜å®ƒå…³è”çš„å€¼åº”è¯¥æ˜¯å ç”¨ 32 ä½ç©ºé—´çš„æ— ç¬¦å·æ•´å‹ï¼ˆæœ‰ç¬¦å·æ•´å‹ä»¥ `i` å¼€å§‹ï¼Œ`i` æ˜¯è‹±æ–‡å•è¯ *integer* çš„é¦–å­—æ¯ï¼Œä¸ä¹‹ç›¸åçš„æ˜¯ `u`ï¼Œä»£è¡¨æ— ç¬¦å· `unsigned` ç±»å‹ï¼‰ã€‚è¡¨ 3-1 æ˜¾ç¤ºäº† Rust ä¸­çš„å†…ç½®çš„æ•´æ•°ç±»å‹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›å®šä¹‰å½¢å¼ä¸­çš„ä»»ä½•ä¸€ä¸ªæ¥å£°æ˜æ•´æ•°å€¼çš„ç±»å‹ã€‚

è¡¨ 3-1: Rust ä¸­çš„æ•´å‹

| é•¿åº¦   | æœ‰ç¬¦å·ç±»å‹ | æ— ç¬¦å·ç±»å‹ |
| ------ | ---------- | ---------- |
| 8 ä½   | `i8`       | `u8`       |
| 16 ä½  | `i16`      | `u16`      |
| 32 ä½  | `i32`      | `u32`      |
| 64 ä½  | `i64`      | `u64`      |
| 128 ä½ | `i128`     | `u128`     |
| arch   | `isize`    | `usize`    |

æ¯ä¸ªå®šä¹‰å½¢å¼è¦ä¹ˆæ˜¯æœ‰ç¬¦å·ç±»å‹è¦ä¹ˆæ˜¯æ— ç¬¦å·ç±»å‹ï¼Œä¸”å¸¦æœ‰ä¸€ä¸ªæ˜¾å¼çš„å¤§å°ã€‚**æœ‰ç¬¦å·**å’Œ**æ— ç¬¦å·**è¡¨ç¤ºæ•°å­—èƒ½å¦å–è´Ÿæ•°â€”â€”ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªæ•°æ˜¯å¦å¯èƒ½æ˜¯è´Ÿæ•°ï¼ˆæœ‰ç¬¦å·ç±»å‹ï¼‰ï¼Œæˆ–ä¸€ç›´ä¸ºæ­£è€Œä¸éœ€è¦å¸¦ä¸Šç¬¦å·ï¼ˆæ— ç¬¦å·ç±»å‹ï¼‰ã€‚å°±åƒåœ¨çº¸ä¸Šå†™æ•°å­—ä¸€æ ·ï¼šå½“è¦å¼ºè°ƒç¬¦å·æ—¶ï¼Œæ•°å­—å‰é¢å¯ä»¥å¸¦ä¸Šæ­£å·æˆ–è´Ÿå·ï¼›ç„¶è€Œï¼Œå½“å¾ˆæ˜æ˜¾ç¡®å®šæ•°å­—ä¸ºæ­£æ•°æ—¶ï¼Œå°±ä¸éœ€è¦åŠ ä¸Šæ­£å·äº†ã€‚æœ‰ç¬¦å·æ•°å­—ä»¥[äºŒè¿›åˆ¶è¡¥ç ](https://en.wikipedia.org/wiki/Two's_complement)ï¼ˆè¯‘è€…è¡¥å……ï¼š[â€œè¡¥ç â€ç™¾åº¦ç™¾ç§‘](https://baike.baidu.com/item/è¡¥ç /6854613)ï¼‰å½¢å¼å­˜å‚¨ã€‚

æ¯ä¸ªæœ‰ç¬¦å·ç±»å‹è§„å®šçš„æ•°å­—èŒƒå›´æ˜¯ -(2n - 1) ~ 2n - 1 - 1ï¼Œå…¶ä¸­ `n` æ˜¯è¯¥å®šä¹‰å½¢å¼çš„ä½é•¿åº¦ã€‚æ‰€ä»¥ `i8` å¯å­˜å‚¨æ•°å­—èŒƒå›´æ˜¯ -(27) ~ 27 - 1ï¼Œå³ -128 ~ 127ã€‚æ— ç¬¦å·ç±»å‹å¯ä»¥å­˜å‚¨çš„æ•°å­—èŒƒå›´æ˜¯ 0 ~ 2n - 1ï¼Œæ‰€ä»¥ `u8` èƒ½å¤Ÿå­˜å‚¨çš„æ•°å­—ä¸º 0 ~ 28 - 1ï¼Œå³ 0 ~ 255ã€‚

æ­¤å¤–ï¼Œ`isize` å’Œ `usize` ç±»å‹å–å†³äºç¨‹åºè¿è¡Œçš„è®¡ç®—æœºä½“ç³»ç»“æ„ï¼Œåœ¨è¡¨ä¸­è¡¨ç¤ºä¸ºâ€œarchâ€ï¼šè‹¥ä½¿ç”¨ 64 ä½æ¶æ„ç³»ç»Ÿåˆ™ä¸º 64 ä½ï¼Œè‹¥ä½¿ç”¨ 32 ä½æ¶æ„ç³»ç»Ÿåˆ™ä¸º 32 ä½ã€‚

ä½ å¯æŒ‰è¡¨ 3-2 ä¸­æ‰€ç¤ºçš„ä»»æ„å½¢å¼æ¥ç¼–å†™æ•´å‹çš„å­—é¢é‡ã€‚æ³¨æ„ï¼Œå¯èƒ½å±äºå¤šç§æ•°å­—ç±»å‹çš„æ•°å­—å­—é¢é‡å…è®¸ä½¿ç”¨ç±»å‹åç¼€æ¥æŒ‡å®šç±»å‹ï¼Œä¾‹å¦‚ `57u8`ã€‚æ•°å­—å­—é¢é‡è¿˜å¯ä»¥ä½¿ç”¨ `_` ä½œä¸ºå¯è§†åˆ†éš”ç¬¦ä»¥æ–¹ä¾¿è¯»æ•°ï¼Œå¦‚ `1_000`ï¼Œæ­¤å€¼å’Œ `1000` ç›¸åŒã€‚

è¡¨ 3-2: Rust çš„æ•´å‹å­—é¢é‡

| æ•°å­—å­—é¢é‡         | ç¤ºä¾‹          |
| ------------------ | ------------- |
| åè¿›åˆ¶             | `98_222`      |
| åå…­è¿›åˆ¶           | `0xff`        |
| å…«è¿›åˆ¶             | `0o77`        |
| äºŒè¿›åˆ¶             | `0b1111_0000` |
| å­—èŠ‚ (ä»…é™äº `u8`) | `b'A'`        |

é‚£ä¹ˆè¯¥ä½¿ç”¨å“ªç§ç±»å‹çš„æ•´å‹å‘¢ï¼Ÿå¦‚æœä¸ç¡®å®šï¼ŒRust çš„é»˜è®¤å½¢å¼é€šå¸¸æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œæ•´å‹é»˜è®¤æ˜¯ `i32`ã€‚`isize` å’Œ `usize` çš„ä¸»è¦åº”ç”¨åœºæ™¯æ˜¯ç”¨ä½œæŸäº›é›†åˆçš„ç´¢å¼•ã€‚

!!! note "æ•´å‹æº¢å‡º"

    æ¯”æ–¹è¯´æœ‰ä¸€ä¸ª `u8` ï¼Œå®ƒå¯ä»¥å­˜æ”¾ä» 0 åˆ° 255 çš„å€¼ã€‚é‚£ä¹ˆå½“ä½ å°†å…¶ä¿®æ”¹ä¸ºèŒƒå›´ä¹‹å¤–çš„å€¼ï¼Œæ¯”å¦‚ 256ï¼Œåˆ™ä¼šå‘ç”Ÿ **æ•´å‹æº¢å‡º**ï¼ˆ*integer overflow*ï¼‰ï¼Œè¿™ä¼šå¯¼è‡´ä¸¤ç§è¡Œä¸ºçš„å…¶ä¸­ä¸€ç§ã€‚å½“åœ¨è°ƒè¯•ï¼ˆdebugï¼‰æ¨¡å¼ç¼–è¯‘æ—¶ï¼ŒRust ä¼šæ£€æŸ¥æ•´å‹æº¢å‡ºï¼Œè‹¥å­˜åœ¨è¿™äº›é—®é¢˜åˆ™ä½¿ç¨‹åºåœ¨ç¼–è¯‘æ—¶ *panic*ã€‚Rust ä½¿ç”¨ panic è¿™ä¸ªæœ¯è¯­æ¥è¡¨æ˜ç¨‹åºå› é”™è¯¯è€Œé€€å‡ºã€‚ç¬¬ 9 ç«  [â€œ`panic!` ä¸ä¸å¯æ¢å¤çš„é”™è¯¯â€](https://rustwiki.org/zh-CN/book/ch09-01-unrecoverable-errors-with-panic.html)ä¼šè¯¦ç»†ä»‹ç» panicã€‚
    
    åœ¨å½“ä½¿ç”¨ `--release` å‚æ•°è¿›è¡Œå‘å¸ƒï¼ˆreleaseï¼‰æ¨¡å¼æ„å»ºæ—¶ï¼ŒRust **ä¸** æ£€æµ‹ä¼šå¯¼è‡´ panic çš„æ•´å‹æº¢å‡ºã€‚ç›¸åå½“æ£€æµ‹åˆ°æ•´å‹æº¢å‡ºæ—¶ï¼ŒRust ä¼šè¿›è¡Œä¸€ç§è¢«ç§°ä¸ºäºŒè¿›åˆ¶è¡¥ç åŒ…è£¹ï¼ˆ*twoâ€™s complement wrapping*ï¼‰çš„æ“ä½œã€‚ç®€è€Œè¨€ä¹‹ï¼Œå¤§äºè¯¥ç±»å‹æœ€å¤§å€¼çš„æ•°å€¼ä¼šè¢«â€œåŒ…è£¹â€æˆè¯¥ç±»å‹èƒ½å¤Ÿæ”¯æŒçš„å¯¹åº”æ•°å­—çš„æœ€å°å€¼ã€‚æ¯”å¦‚åœ¨ `u8` çš„æƒ…å†µä¸‹ï¼Œ256 å˜æˆ 0ï¼Œ257 å˜æˆ 1ï¼Œä¾æ­¤ç±»æ¨ã€‚ç¨‹åºä¸ä¼š panicï¼Œä½†æ˜¯è¯¥å˜é‡çš„å€¼å¯èƒ½ä¸æ˜¯ä½ æœŸæœ›çš„å€¼ã€‚ä¾èµ–æ•´å‹æº¢å‡ºåŒ…è£¹çš„è¡Œä¸ºä¸æ˜¯ä¸€ç§æ­£ç¡®çš„åšæ³•ã€‚

    è¦æ˜¾å¼å¤„ç†æº¢å‡ºçš„å¯èƒ½æ€§ï¼Œå¯ä»¥ä½¿ç”¨æ ‡å‡†åº“é’ˆå¯¹åŸå§‹æ•°å­—ç±»å‹æä¾›çš„ä»¥ä¸‹ä¸€ç³»åˆ—æ–¹æ³•ï¼š

    - ä½¿ç”¨ `wrapping_*` æ–¹æ³•åœ¨æ‰€æœ‰æ¨¡å¼ä¸‹è¿›è¡ŒåŒ…è£¹ï¼Œä¾‹å¦‚ `wrapping_add`
    - å¦‚æœä½¿ç”¨ `checked_*` æ–¹æ³•æ—¶å‘ç”Ÿæº¢å‡ºï¼Œåˆ™è¿”å› `None` å€¼
    - ä½¿ç”¨ `overflowing_*` æ–¹æ³•è¿”å›è¯¥å€¼å’Œä¸€ä¸ªæŒ‡ç¤ºæ˜¯å¦å­˜åœ¨æº¢å‡ºçš„å¸ƒå°”å€¼
    - ä½¿ç”¨ `saturating_*` æ–¹æ³•ä½¿å€¼è¾¾åˆ°æœ€å°å€¼æˆ–æœ€å¤§

#### 2.1.2 æµ®ç‚¹ç±»å‹

**æµ®ç‚¹æ•°**ï¼ˆ*floating-point number*ï¼‰æ˜¯å¸¦æœ‰å°æ•°ç‚¹çš„æ•°å­—ï¼Œåœ¨ Rust ä¸­æµ®ç‚¹ç±»å‹ï¼ˆç®€ç§°æµ®ç‚¹å‹ï¼‰æ•°å­—ä¹Ÿæœ‰ä¸¤ç§åŸºæœ¬ç±»å‹ã€‚Rust çš„æµ®ç‚¹å‹æ˜¯ `f32` å’Œ `f64`ï¼Œå®ƒä»¬çš„å¤§å°åˆ†åˆ«ä¸º 32 ä½å’Œ 64 ä½ã€‚é»˜è®¤æµ®ç‚¹ç±»å‹æ˜¯ `f64`ï¼Œå› ä¸ºåœ¨ç°ä»£çš„ CPU ä¸­å®ƒçš„é€Ÿåº¦ä¸ `f32` çš„å‡ ä¹ç›¸åŒï¼Œä½†ç²¾åº¦æ›´é«˜ã€‚æ‰€æœ‰æµ®ç‚¹å‹éƒ½æ˜¯æœ‰ç¬¦å·çš„ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªæ¼”ç¤ºæµ®ç‚¹æ•°çš„ç¤ºä¾‹ï¼š

```rust linenums="1" title="src/main.rs"
fn main() {
    let x = 2.0; // f64

    let y: f32 = 3.0; // f32
}
```

æµ®ç‚¹æ•°æŒ‰ç…§ IEEE-754 æ ‡å‡†è¡¨ç¤ºã€‚`f32` ç±»å‹æ˜¯å•ç²¾åº¦æµ®ç‚¹å‹ï¼Œ`f64` ä¸ºåŒç²¾åº¦æµ®ç‚¹å‹ã€‚

#### 2.1.3 æ•°å­—è¿ç®—

Rust çš„æ‰€æœ‰æ•°å­—ç±»å‹éƒ½æ”¯æŒåŸºæœ¬æ•°å­¦è¿ç®—ï¼šåŠ æ³•ã€å‡æ³•ã€ä¹˜æ³•ã€é™¤æ³•å’Œå–æ¨¡è¿ç®—ã€‚æ•´æ•°é™¤æ³•ä¼šå‘ä¸‹å–æ•´ã€‚ä¸‹é¢ä»£ç æ¼”ç¤ºäº†å„ä½¿ç”¨ä¸€æ¡ `let` è¯­å¥æ¥è¯´æ˜ç›¸åº”æ•°å­—è¿ç®—çš„ç”¨æ³•ï¼š

æ–‡ä»¶åï¼šsrc/main.rs

```rust title="src/main.rs" linenums="1"
fn main() {
    // åŠ 
    let sum = 5 + 10;

    // å‡
    let difference = 95.5 - 4.3;

    // ä¹˜
    let product = 4 * 30;

    // é™¤
    let quotient = 56.7 / 32.2;
    let floored = 2 / 3; // Results in 0

    // é™¤ä½™
    let remainder = 43 % 5;
}
```

è¿™äº›è¯­å¥ä¸­çš„æ¯ä¸ªè¡¨è¾¾å¼éƒ½ä½¿ç”¨äº†æ•°å­¦è¿ç®—ç¬¦ï¼Œå¹¶ä¸”è®¡ç®—ç»“æœä¸ºä¸€ä¸ªå€¼ï¼Œç„¶åç»‘å®šåˆ°ä¸€ä¸ªå˜é‡ä¸Šã€‚[é™„å½• B](https://rustwiki.org/zh-CN/book/appendix-02-operators.html) ç½—åˆ—äº† Rust æä¾›çš„æ‰€æœ‰è¿ç®—ç¬¦çš„åˆ—è¡¨ã€‚

#### 2.1.4 å¸ƒå°”ç±»å‹

å’Œå¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¸€æ ·ï¼ŒRust ä¸­çš„å¸ƒå°”ç±»å‹ä¹Ÿæœ‰ä¸¤ä¸ªå¯èƒ½çš„å€¼ï¼š`true` å’Œ `false`ã€‚å¸ƒå°”å€¼çš„å¤§å°ä¸º 1 ä¸ªå­—èŠ‚ã€‚Rust ä¸­çš„å¸ƒå°”ç±»å‹ä½¿ç”¨ `bool` å£°æ˜ã€‚ä¾‹å¦‚ï¼š

æ–‡ä»¶åï¼šsrc/main.rs

```rust title="src/main.rs"
fn main() {
    let t = true;

    let f: bool = false; // with explicit type annotation
}
```

ä½¿ç”¨å¸ƒå°”å€¼çš„ä¸»è¦åœ°æ–¹æ˜¯æ¡ä»¶åˆ¤æ–­ï¼Œå¦‚ `if` è¡¨è¾¾å¼ã€‚æˆ‘ä»¬å°†ä¼šåœ¨[â€œæ§åˆ¶æµâ€](https://rustwiki.org/zh-CN/book/ch03-05-control-flow.html#æ§åˆ¶æµ)ç« èŠ‚ä¸­ä»‹ç» `if` è¡¨è¾¾å¼åœ¨ Rust ä¸­çš„ç”¨æ³•ã€‚

#### [å­—ç¬¦ç±»å‹](https://rustwiki.org/zh-CN/book/ch03-02-data-types.html#å­—ç¬¦ç±»å‹)

Rust çš„ `char`ï¼ˆå­—ç¬¦ï¼‰ç±»å‹æ˜¯è¯¥è¯­è¨€æœ€åŸºæœ¬çš„å­—æ¯ç±»å‹ï¼Œä¸‹é¢æ˜¯ä¸€äº›å£°æ˜ `char` å€¼çš„ä¾‹å­ï¼š

æ–‡ä»¶åï¼šsrc/main.rs

```rust
fn main() {
    let c = 'z';
    let z = 'â„¤';
    let heart_eyed_cat = 'ğŸ˜»';
}
```

æ³¨æ„ï¼Œæˆ‘ä»¬å£°æ˜çš„ `char` å­—é¢é‡é‡‡ç”¨å•å¼•å·æ‹¬èµ·æ¥ï¼Œè¿™ä¸å­—ç¬¦ä¸²å­—é¢é‡ä¸åŒï¼Œå­—ç¬¦ä¸²å­—é¢é‡æ˜¯ç”¨åŒå¼•å·æ‹¬èµ·æ¥ã€‚Rust çš„å­—ç¬¦ç±»å‹å¤§å°ä¸º 4 ä¸ªå­—èŠ‚ï¼Œè¡¨ç¤ºçš„æ˜¯ä¸€ä¸ª Unicode æ ‡é‡å€¼ï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥è¡¨ç¤ºçš„è¿œè¿œä¸æ­¢æ˜¯ ASCIIã€‚æ ‡éŸ³å­—æ¯ï¼Œä¸­æ–‡/æ—¥æ–‡/éŸ©æ–‡çš„æ–‡å­—ï¼Œemojiï¼Œè¿˜æœ‰é›¶å®½ç©ºæ ¼(zero width space)åœ¨ Rust ä¸­éƒ½æ˜¯åˆæ³•çš„å­—ç¬¦ç±»å‹ã€‚Unicode å€¼çš„èŒƒå›´ä¸º `U+0000` ~ `U+D7FF` å’Œ `U+E000`~`U+10FFFF`ã€‚ä¸è¿‡â€œå­—ç¬¦â€å¹¶ä¸æ˜¯ Unicode ä¸­çš„ä¸€ä¸ªæ¦‚å¿µï¼Œæ‰€ä»¥äººåœ¨ç›´è§‰ä¸Šå¯¹â€œå­—ç¬¦â€çš„ç†è§£å’Œ Rust çš„å­—ç¬¦æ¦‚å¿µå¹¶ä¸ä¸€è‡´ã€‚æˆ‘ä»¬å°†åœ¨ç¬¬ 8 ç« [â€œä½¿ç”¨å­—ç¬¦ä¸²å­˜å‚¨ UTF-8 ç¼–ç çš„æ–‡æœ¬â€](https://rustwiki.org/zh-CN/book/ch08-02-strings.html#ä½¿ç”¨å­—ç¬¦ä¸²å­˜å‚¨-utf-8-ç¼–ç çš„æ–‡æœ¬)ä¸­è¯¦ç»†è®¨è®ºè¿™ä¸ªä¸»é¢˜ã€‚

### 2.2 å¤åˆç±»å‹

**å¤åˆç±»å‹**ï¼ˆ*compound type*ï¼‰å¯ä»¥å°†å¤šä¸ªå€¼ç»„åˆæˆä¸€ä¸ªç±»å‹ã€‚Rust æœ‰ä¸¤ç§åŸºæœ¬çš„å¤åˆç±»å‹ï¼š**å…ƒç»„**ï¼ˆtupleï¼‰å’Œ **æ•°ç»„**ï¼ˆarrayï¼‰ã€‚

#### 2.2.1 å…ƒç»„ç±»å‹

å…ƒç»„æ˜¯å°†å¤šç§ç±»å‹çš„å¤šä¸ªå€¼ç»„åˆåˆ°ä¸€ä¸ªå¤åˆç±»å‹ä¸­çš„ä¸€ç§åŸºæœ¬æ–¹å¼ã€‚å…ƒç»„çš„é•¿åº¦æ˜¯å›ºå®šçš„ï¼šå£°æ˜åï¼Œå®ƒä»¬å°±æ— æ³•å¢é•¿æˆ–ç¼©å°ã€‚

æˆ‘ä»¬é€šè¿‡åœ¨å°æ‹¬å·å†…å†™å…¥ä»¥é€—å·åˆ†éš”çš„å€¼åˆ—è¡¨æ¥åˆ›å»ºä¸€ä¸ªå…ƒç»„ã€‚å…ƒç»„ä¸­çš„æ¯ä¸ªä½ç½®éƒ½æœ‰ä¸€ä¸ªç±»å‹ï¼Œå¹¶ä¸”å…ƒç»„ä¸­ä¸åŒå€¼çš„ç±»å‹ä¸è¦æ±‚æ˜¯ç›¸åŒçš„ã€‚æˆ‘ä»¬åœ¨ä¸‹é¢ç¤ºä¾‹ä¸­æ·»åŠ äº†å¯é€‰çš„ç±»å‹æ ‡æ³¨ï¼š

```rust title="src/main.rs" linenums="1"
fn main() {
    let tup: (i32, f64, u8) = (500, 6.4, 1);
}
```

å˜é‡ `tup` ç»‘å®šåˆ°æ•´ä¸ªå…ƒç»„ï¼Œå› ä¸ºå…ƒç»„è¢«è®¤ä½œæ˜¯å•ä¸ªå¤åˆå…ƒç´ ã€‚æƒ³ä»å…ƒç»„ä¸­è·å–ä¸ªåˆ«å€¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¨¡å¼åŒ¹é…æ¥ **è§£æ„**ï¼ˆdestructureï¼‰å…ƒç»„çš„ä¸€ä¸ªå€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```rust title="src/main.rs" linenums="1"
fn main() {
    let tup = (500, 6.4, 1);

    let (x, y, z) = tup;

    println!("The value of y is: {}", y);
}
```

è¯¥ç¨‹åºé¦–å…ˆåˆ›å»ºä¸€ä¸ªå…ƒç»„å¹¶å°†å…¶ç»‘å®šåˆ°å˜é‡ `tup` ä¸Šã€‚ ç„¶åå®ƒå€ŸåŠ© `let` æ¥ä½¿ç”¨ä¸€ä¸ªæ¨¡å¼åŒ¹é… `tup`ï¼Œå¹¶å°†å®ƒåˆ†è§£æˆä¸‰ä¸ªå•ç‹¬çš„å˜é‡ `x`ã€`y` å’Œ `z`ã€‚è¿™è¿‡ç¨‹ç§°ä¸º **è§£æ„**ï¼ˆ*destructuring*ï¼‰ï¼Œå› ä¸ºå®ƒå°†å•ä¸ªå…ƒç»„åˆ†ä¸ºä¸‰éƒ¨åˆ†ã€‚æœ€åï¼Œç¨‹åºæ‰“å°å‡º `y` å€¼ï¼Œä¸º `6.4`ã€‚

é™¤äº†é€šè¿‡æ¨¡å¼åŒ¹é…è¿›è¡Œè§£æ„å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå¥ç‚¹ï¼ˆ`.`ï¼‰è¿ä¸Šè¦è®¿é—®çš„å€¼çš„ç´¢å¼•æ¥ç›´æ¥è®¿é—®å…ƒç»„å…ƒç´ ã€‚ä¾‹å¦‚ï¼š

```rust title="src/main.rs" linenums="1"
fn main() {
    let x: (i32, f64, u8) = (500, 6.4, 1);

    let five_hundred = x.0;

    let six_point_four = x.1;

    let one = x.2;
}
```

è¯¥ç¨‹åºåˆ›å»ºä¸€ä¸ªå…ƒç»„ `x`ï¼Œç„¶åé€šè¿‡ä½¿ç”¨å®ƒä»¬çš„ç´¢å¼•ä¸ºæ¯ä¸ªå…ƒç´ åˆ›å»ºæ–°çš„å˜é‡ã€‚å’Œå¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¸€æ ·ï¼Œå…ƒç»„ä¸­çš„ç¬¬ä¸€ä¸ªç´¢å¼•ä¸º 0ã€‚

æ²¡æœ‰ä»»ä½•å€¼çš„å…ƒç»„ `()` æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç±»å‹ï¼Œåªæœ‰ä¸€ä¸ªå€¼ï¼Œä¹Ÿå†™æˆ `()`ã€‚è¯¥ç±»å‹è¢«ç§°ä¸º **å•å…ƒç±»å‹**ï¼ˆ*unit type*ï¼‰ï¼Œè¯¥å€¼è¢«ç§°ä¸º **å•å…ƒå€¼**ï¼ˆ*unit value*ï¼‰ã€‚å¦‚æœè¡¨è¾¾å¼ä¸è¿”å›ä»»ä½•å…¶ä»–å€¼ï¼Œå°±éšå¼åœ°è¿”å›å•å…ƒå€¼ã€‚

#### 2.2.2 æ•°ç»„ç±»å‹

å°†å¤šä¸ªå€¼ç»„åˆåœ¨ä¸€èµ·çš„å¦ä¸€ç§æ–¹å¼å°±æ˜¯ä½¿ç”¨ **æ•°ç»„**ï¼ˆ*array*ï¼‰ã€‚ä¸å…ƒç»„ä¸åŒï¼Œæ•°ç»„çš„æ¯ä¸ªå…ƒç´ å¿…é¡»å…·æœ‰ç›¸åŒçš„ç±»å‹ã€‚ä¸æŸäº›å…¶ä»–è¯­è¨€ä¸­çš„æ•°ç»„ä¸åŒï¼ŒRust ä¸­çš„æ•°ç»„å…·æœ‰å›ºå®šé•¿åº¦ã€‚

æˆ‘ä»¬åœ¨æ–¹æ‹¬å·å†…ä»¥é€—å·åˆ†éš”çš„åˆ—è¡¨å½¢å¼å°†å€¼å†™åˆ°æ•°ç»„ä¸­ï¼š

```rust linenums="1"
fn main() {
    let a = [1, 2, 3, 4, 5];
}
```

å½“ä½ å¸Œæœ›å°†æ•°æ®åˆ†é…åˆ°æ ˆï¼ˆstackï¼‰è€Œä¸æ˜¯å †ï¼ˆheapï¼‰æ—¶ï¼ˆæˆ‘ä»¬å°†åœ¨[ç¬¬ 4 ç« ](https://rustwiki.org/zh-CN/book/ch04-01-what-is-ownership.html#æ ˆstackä¸å †heap)ä¸­è¿›ä¸€æ­¥è®¨è®ºæ ˆå’Œå †ï¼‰ï¼Œæˆ–è€…å½“ä½ å¸Œæœ›ç¡®ä¿å§‹ç»ˆå…·æœ‰å›ºå®šæ•°é‡çš„å…ƒç´ æ—¶ï¼Œæ•°ç»„ç‰¹åˆ«æœ‰ç”¨ã€‚ä½†å®ƒä»¬ä¸åƒ vectorï¼ˆè¯‘æ³¨ï¼šä¸­æ–‡å­—é¢ç¿»è¯‘ä¸ºâ€œå‘é‡â€ï¼Œåœ¨ Rust ä¸­æ„ä¹‰ä¸ºâ€œåŠ¨æ€æ•°ç»„ï¼Œå¯å˜æ•°ç»„â€ï¼‰ç±»å‹é‚£ä¹ˆçµæ´»ã€‚vector ç±»å‹ç±»ä¼¼äºæ ‡å‡†åº“ä¸­æä¾›çš„é›†åˆç±»å‹ï¼Œå…¶å¤§å° **å…è®¸** å¢é•¿æˆ–ç¼©å°ã€‚å¦‚æœä¸ç¡®å®šæ˜¯ä½¿ç”¨æ•°ç»„è¿˜æ˜¯ vectorï¼Œé‚£å°±åº”è¯¥ä½¿ç”¨ä¸€ä¸ª vectorã€‚[ç¬¬ 8 ç« ](https://rustwiki.org/zh-CN/book/ch08-01-vectors.html) å°†è¯¦ç»†åœ°è®¨è®º vectorã€‚

ä¸è¿‡å½“ä½ æ˜ç¡®å…ƒç´ æ•°é‡ä¸éœ€è¦æ”¹å˜æ—¶ï¼Œæ•°ç»„ä¼šæ›´æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ åœ¨ç¨‹åºä¸­ä½¿ç”¨æœˆä»½çš„åç§°ï¼Œä½ å¾ˆå¯èƒ½å¸Œæœ›ä½¿ç”¨çš„æ˜¯æ•°ç»„è€Œä¸æ˜¯ vectorï¼Œå› ä¸ºä½ çŸ¥é“å®ƒå§‹ç»ˆåŒ…å« 12 ä¸ªå…ƒç´ ï¼š

```rust linenums="1"
let months = ["January", "February", "March", "April", "May", "June", "July",
              "August", "September", "October", "November", "December"];
```

ä½¿ç”¨æ–¹æ‹¬å·ç¼–å†™æ•°ç»„çš„ç±»å‹ï¼Œå…¶ä¸­åŒ…å«æ¯ä¸ªå…ƒç´ çš„ç±»å‹ã€åˆ†å·ï¼Œç„¶åæ˜¯æ•°ç»„ä¸­çš„å…ƒç´ æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```rust 
let a: [i32; 5] = [1, 2, 3, 4, 5];
```

è¿™é‡Œï¼Œ`i32` æ˜¯æ¯ä¸ªå…ƒç´ çš„ç±»å‹ã€‚åˆ†å·ä¹‹åï¼Œæ•°å­— `5` è¡¨æ˜è¯¥æ•°ç»„åŒ…å« 5 ä¸ªå…ƒç´ ã€‚

ä»¥è¿™ç§æ–¹å¼ç¼–å†™æ•°ç»„çš„ç±»å‹çœ‹èµ·æ¥ç±»ä¼¼äºåˆå§‹åŒ–æ•°ç»„çš„å¦ä¸€ç§è¯­æ³•ï¼šå¦‚æœè¦ä¸ºæ¯ä¸ªå…ƒç´ åˆ›å»ºåŒ…å«ç›¸åŒå€¼çš„æ•°ç»„ï¼Œå¯ä»¥æŒ‡å®šåˆå§‹å€¼ï¼Œåè·Ÿåˆ†å·ï¼Œç„¶ååœ¨æ–¹æ‹¬å·ä¸­æŒ‡å®šæ•°ç»„çš„é•¿åº¦ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```rust linenums="1"
let a = [3; 5];
```

å˜é‡åä¸º `a` çš„æ•°ç»„å°†åŒ…å« `5` ä¸ªå…ƒç´ ï¼Œè¿™äº›å…ƒç´ çš„å€¼åˆå§‹åŒ–ä¸º `3`ã€‚è¿™ç§å†™æ³•ä¸ `let a = [3, 3, 3, 3, 3];` æ•ˆæœç›¸åŒï¼Œä½†æ›´ç®€æ´ã€‚

##### è®¿é—®æ•°ç»„å…ƒç´ 

æ•°ç»„æ˜¯å¯ä»¥åœ¨æ ˆä¸Šåˆ†é…çš„å·²çŸ¥å›ºå®šå¤§å°çš„å•ä¸ªå†…å­˜å—ã€‚å¯ä»¥ä½¿ç”¨ç´¢å¼•è®¿é—®æ•°ç»„çš„å…ƒç´ ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š


```rust title="src/main.rs" linenums="1"
fn main() {
    let a = [1, 2, 3, 4, 5];

    let first = a[0];
    let second = a[1];
}
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œåä¸º `first` çš„å˜é‡å°†è·å¾—å€¼ `1`ï¼Œå› ä¸ºå®ƒæ˜¯æ•°ç»„ä¸­ç´¢å¼• `[0]` å¤„çš„å€¼ã€‚åä¸º `second` çš„å˜é‡å°†ä»æ•°ç»„ä¸­çš„ç´¢å¼• `[1]` ä¸­è·å–å¾— `2`ã€‚

##### æ— æ•ˆçš„æ•°ç»„å…ƒç´ è®¿é—®

å¦‚æœå°è¯•è®¿é—®è¶…å‡ºæ•°ç»„æœ«å°¾çš„æ•°ç»„å…ƒç´ ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ å‡å¦‚ä½ å°†ç¤ºä¾‹æ›´æ”¹ä¸ºä»¥ä¸‹å†…å®¹ï¼Œä½¿ç”¨ç±»ä¼¼äºç¬¬ 2 ç« çŒœæ•°å­—æ¸¸æˆçš„ä»£ç é‚£æ ·ä»ç”¨æˆ·è·å–æ•°ç»„ç´¢å¼•ï¼š

```rust title="src/main.rs" linenums="1"
use std::io;

fn main() {
    let a = [1, 2, 3, 4, 5];

    println!("Please enter an array index.");

    let mut index = String::new();

    io::stdin()
        .read_line(&mut index)
        .expect("Failed to read line");

    let index: usize = index
        .trim()
        .parse()
        .expect("Index entered was not a number");

    let element = a[index];

    println!(
        "The value of the element at index {} is: {}",
        index, element
    );
}
```

æ­¤ä»£ç ç¼–è¯‘æˆåŠŸã€‚å¦‚æœä½¿ç”¨ `cargo run` æ¥è¿è¡Œæ­¤ä»£ç å¹¶è¾“å…¥ 0ã€1ã€2ã€3 æˆ– 4ï¼Œåˆ™ç¨‹åºå°†æ‰“å°æ•°ç»„å¯¹åº”ç´¢å¼•çš„å€¼ã€‚å¦‚æœè¾“å…¥çš„æ˜¯è¶…å‡ºæ•°ç»„æœ«å°¾çš„æ•°å­—ï¼Œä¾‹å¦‚ 10ï¼Œåˆ™ä¼šçœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹çš„è¾“å‡ºï¼š

```console
thread 'main' panicked at 'index out of bounds: the len is 5 but the index is 10', src/main.rs:19:19
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
```

è¯¥ç¨‹åºåœ¨ç´¢å¼•æ“ä½œä¸­ä½¿ç”¨æ— æ•ˆå€¼æ—¶å¯¼è‡´**è¿è¡Œæ—¶**ï¼ˆ*runtime*ï¼‰é”™è¯¯ã€‚ç¨‹åºé€€å‡ºå¹¶æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯ï¼Œæœªæ‰§è¡Œåé¢çš„ `println!` è¯­å¥ã€‚å½“ä½ å°è¯•ä½¿ç”¨ç´¢å¼•è®¿é—®å…ƒç´ æ—¶ï¼ŒRust å°†æ£€æŸ¥ä½ æŒ‡å®šçš„ç´¢å¼•æ˜¯å¦å°äºæ•°ç»„é•¿åº¦ã€‚å¦‚æœç´¢å¼•å¤§äºæˆ–ç­‰äºæ•°ç»„é•¿åº¦ï¼ŒRust ä¼šå‡ºç° `panic`ã€‚è¿™ç§æ£€æŸ¥å¿…é¡»åœ¨è¿è¡Œæ—¶è¿›è¡Œï¼Œå°¤å…¶æ˜¯åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå› ä¸ºç¼–è¯‘å™¨å¯èƒ½æ— æ³•çŸ¥é“ç”¨æˆ·ä¹‹åè¿è¡Œä»£ç æ—¶å°†è¾“å…¥ä»€ä¹ˆå€¼ã€‚

è¿™æ˜¯ Rust åœ¨å®è·µä¸­å®‰å…¨åŸåˆ™çš„ç¬¬ä¸€ä¸ªä¾‹å­ã€‚åœ¨å¾ˆå¤šä½çº§è¯­è¨€ä¸­ï¼Œå¹¶ä¸è¿›è¡Œè¿™ç§æ£€æŸ¥ï¼Œè€Œä¸”åœ¨ä½ ä½¿ç”¨ä¸æ­£ç¡®çš„ç´¢å¼•æ—¶ï¼Œå¯ä»¥è®¿é—®æ— æ•ˆçš„å†…å­˜ã€‚Rust é€šè¿‡ç«‹å³é€€å‡ºæ¥çš„æ–¹å¼é˜²æ­¢è¿™ç§é”™è¯¯ï¼Œè€Œä¸æ˜¯å…è®¸å†…å­˜è®¿é—®å¹¶ç»§ç»­è¿è¡Œç¨‹åºã€‚ç¬¬ 9 ç« å°†è¿›ä¸€æ­¥è®¨è®º Rust çš„é”™è¯¯å¤„ç†ã€‚

## 3. å‡½æ•°

å‡½æ•°åœ¨ Rust ä»£ç ä¸­å¾ˆæ™®éã€‚ä½ å·²ç»è§è¿‡è¯­è¨€ä¸­æœ€é‡è¦çš„å‡½æ•°ä¹‹ä¸€ï¼š`main` å‡½æ•°ï¼Œå®ƒæ˜¯å¾ˆå¤šç¨‹åºçš„å…¥å£ç‚¹ã€‚ä½ ä¹Ÿè§è¿‡ `fn` å…³é”®å­—ï¼Œå®ƒç”¨æ¥å£°æ˜æ–°å‡½æ•°ã€‚

Rust ä»£ç ä¸­çš„å‡½æ•°å’Œå˜é‡åä½¿ç”¨ä¸‹åˆ’çº¿å‘½åæ³•ï¼ˆ*snake case*ï¼Œç›´è¯‘ä¸ºè›‡å½¢å‘½åæ³•ï¼‰è§„èŒƒé£æ ¼ã€‚åœ¨ä¸‹åˆ’çº¿å‘½åæ³•ä¸­ï¼Œæ‰€æœ‰å­—æ¯éƒ½æ˜¯å°å†™å¹¶ä½¿ç”¨ä¸‹åˆ’çº¿åˆ†éš”å•è¯ã€‚è¿™æ˜¯ä¸€ä¸ªåŒ…å«å‡½æ•°å®šä¹‰ç¤ºä¾‹çš„ç¨‹åºï¼š

```rust linenums="1" title="src/main.rs"
fn main() {
    println!("Hello, world!");

    another_function();
}

fn another_function() {
    println!("Another function.");
}
```

Rust ä¸­çš„å‡½æ•°å®šä¹‰ä»¥ `fn` å¼€å§‹ï¼Œåè·Ÿç€å‡½æ•°åå’Œä¸€å¯¹åœ†æ‹¬å·ã€‚å¤§æ‹¬å·å‘Šè¯‰ç¼–è¯‘å™¨å‡½æ•°ä½“åœ¨å“ªé‡Œå¼€å§‹å’Œç»“æŸã€‚

å¯ä»¥ä½¿ç”¨å‡½æ•°ååè·Ÿåœ†æ‹¬å·æ¥è°ƒç”¨æˆ‘ä»¬å®šä¹‰è¿‡çš„ä»»æ„å‡½æ•°ã€‚å› ä¸ºç¨‹åºä¸­å·²å®šä¹‰ `another_function` å‡½æ•°ï¼Œæ‰€ä»¥å¯ä»¥åœ¨ `main` å‡½æ•°ä¸­è°ƒç”¨å®ƒã€‚æ³¨æ„ï¼Œæºç ä¸­ `another_function` å®šä¹‰åœ¨ `main` å‡½æ•°**ä¹‹å**ï¼›ä¹Ÿå¯ä»¥å®šä¹‰åœ¨ä¹‹å‰ã€‚Rust ä¸å…³å¿ƒå‡½æ•°å®šä¹‰äºä½•å¤„ï¼Œåªè¦å®šä¹‰äº†å°±è¡Œã€‚

è®©æˆ‘ä»¬æ–°å»ºä¸€ä¸ªå«åš *functions* çš„äºŒè¿›åˆ¶é¡¹ç›®æ¥è¿›ä¸€æ­¥æ¢è®¨å‡½æ•°ã€‚å°†ä¸Šé¢çš„ `another_function` ä¾‹å­å†™å…¥ *src/main.rs* ä¸­å¹¶è¿è¡Œã€‚ä½ åº”è¯¥ä¼šçœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼š

```console
$ cargo run
   Compiling functions v0.1.0 (file:///projects/functions)
    Finished dev [unoptimized + debuginfo] target(s) in 0.28s
     Running `target/debug/functions`
Hello, world!
Another function.
```

`main` å‡½æ•°ä¸­çš„ä»£ç ä¼šæŒ‰é¡ºåºæ‰§è¡Œã€‚é¦–å…ˆï¼Œæ‰“å° â€œHello, world!â€ ä¿¡æ¯ï¼Œç„¶åè°ƒç”¨ `another_function` å‡½æ•°å¹¶æ‰“å°å®ƒçš„ä¿¡æ¯ã€‚

### 3.1 å‚æ•°

å‡½æ•°ä¹Ÿå¯ä»¥è¢«å®šä¹‰ä¸ºæ‹¥æœ‰ **å‚æ•°**ï¼ˆ*parameter*ï¼‰ï¼Œå‚æ•°æ˜¯ç‰¹æ®Šå˜é‡ï¼Œæ˜¯å‡½æ•°ç­¾åçš„ä¸€éƒ¨åˆ†ã€‚å½“å‡½æ•°æ‹¥æœ‰å‚æ•°ï¼ˆå½¢å‚ï¼‰æ—¶ï¼Œå¯ä»¥ä¸ºè¿™äº›å‚æ•°æä¾›å…·ä½“çš„å€¼ï¼ˆå®å‚ï¼‰ã€‚æŠ€æœ¯ä¸Šè®²ï¼Œè¿™äº›å…·ä½“å€¼è¢«ç§°ä¸º **å®å‚**ï¼ˆ*argument*ï¼‰ï¼Œä½†æ˜¯åœ¨æ—¥å¸¸äº¤æµä¸­ï¼Œäººä»¬å€¾å‘äºä¸åŒºåˆ†ä½¿ç”¨ *parameter* å’Œ *argument* æ¥è¡¨ç¤ºå‡½æ•°å®šä¹‰ä¸­çš„å˜é‡æˆ–è°ƒç”¨å‡½æ•°æ—¶ä¼ å…¥çš„å…·ä½“å€¼ã€‚

åœ¨è¿™ä¸ªç‰ˆæœ¬çš„ `another_function` ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªå‚æ•°ï¼š

```rust title="src/main.rs" linenums="1"
fn main() {
    another_function(5);
}

fn another_function(x: i32) {
    println!("The value of x is: {}", x);
}
```

å°è¯•è¿è¡Œç¨‹åºï¼Œå°†ä¼šè¾“å‡ºå¦‚ä¸‹å†…å®¹ï¼š

```console
$ cargo run
   Compiling functions v0.1.0 (file:///projects/functions)
    Finished dev [unoptimized + debuginfo] target(s) in 1.21s
     Running `target/debug/functions`
The value of x is: 5
```

`another_function` çš„å£°æ˜ä¸­æœ‰ä¸€ä¸ªå‘½åä¸º `x` çš„å‚æ•°ã€‚`x` çš„ç±»å‹è¢«æŒ‡å®šä¸º `i32`ã€‚å½“å°† `5` ä¼ ç»™ `another_function` æ—¶ï¼Œ`println!` å®å°† `5` æ”¾å…¥æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­å¤§æ‹¬å·çš„ä½ç½®ã€‚

åœ¨å‡½æ•°ç­¾åä¸­ï¼Œ**å¿…é¡»** å£°æ˜æ¯ä¸ªå‚æ•°çš„ç±»å‹ã€‚è¿™æ˜¯ä¸€ä¸ª Rust è®¾è®¡ä¸­ç»è¿‡æ…é‡è€ƒè™‘çš„å†³å®šï¼šè¦æ±‚åœ¨å‡½æ•°å®šä¹‰ä¸­æä¾›ç±»å‹æ ‡æ³¨ï¼Œæ„å‘³ç€ç¼–è¯‘å™¨å‡ ä¹ä»ä¸éœ€è¦ä½ åœ¨ä»£ç çš„å…¶ä»–åœ°æ–¹æ³¨æ˜ç±»å‹æ¥æŒ‡å‡ºä½ çš„æ„å›¾ã€‚

å½“ä¸€ä¸ªå‡½æ•°æœ‰å¤šä¸ªå‚æ•°æ—¶ï¼Œä½¿ç”¨é€—å·åˆ†éš”ï¼Œåƒè¿™æ ·ï¼š

æ–‡ä»¶å: src/main.rs

```rust
fn main() {
    print_labeled_measurement(5, 'h');
}

fn print_labeled_measurement(value: i32, unit_label: char) {
    println!("The measurement is: {}{}", value, unit_label);
}
```

è¿™ä¸ªä¾‹å­åˆ›å»ºäº†ä¸€ä¸ªæœ‰ä¸¤ä¸ªå‚æ•°çš„åä¸º `print_labeled_measurement` çš„å‡½æ•°ã€‚ç¬¬ä¸€ä¸ªå‚æ•°åä¸º `value`ï¼Œ ç±»å‹æ˜¯ `i32`ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯ `unit_label` ï¼Œç±»å‹æ˜¯ `char`ã€‚æ¥ç€è¯¥å‡½æ•°æ‰“å°åŒ…å« `value` å’Œ `unit_label` çš„æ–‡æœ¬ã€‚

è®©æˆ‘ä»¬å°è¯•è¿è¡Œè¿™æ®µä»£ç ã€‚ä½¿ç”¨ä¸Šé¢çš„ä¾‹å­æ›¿æ¢å½“å‰ *functions* é¡¹ç›®çš„ *src/main.rs* æ–‡ä»¶ï¼Œå¹¶ç”¨ `cargo run` è¿è¡Œå®ƒï¼š

```console
$ cargo run
   Compiling functions v0.1.0 (file:///projects/functions)
    Finished dev [unoptimized + debuginfo] target(s) in 0.31s
     Running `target/debug/functions`
The measurement is: 5h
```

å› ä¸ºæˆ‘ä»¬ä½¿ç”¨ `5` ä½œä¸º `value` çš„å€¼ï¼Œ`h` ä½œä¸º `unit_label` çš„å€¼æ¥è°ƒç”¨å‡½æ•°ï¼Œæ‰€ä»¥ç¨‹åºçš„è¾“å‡ºåŒ…å«è¿™äº›å€¼ã€‚

### 3.2 è¯­å¥å’Œè¡¨è¾¾å¼

å‡½æ•°ä½“ç”±ä¸€ç³»åˆ—è¯­å¥ç»„æˆï¼Œä¹Ÿå¯é€‰æ‹©ä»¥è¡¨è¾¾å¼ç»“å°¾ã€‚ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä»‹ç»çš„å‡½æ•°è¿˜æ²¡æœ‰åŒ…å«ç»“å°¾è¡¨è¾¾å¼ï¼Œä¸è¿‡ä½ å·²ç»çœ‹åˆ°äº†è¡¨è¾¾å¼ä½œä¸ºè¯­å¥çš„ä¸€éƒ¨åˆ†ã€‚å› ä¸º Rust æ˜¯ä¸€é—¨åŸºäºè¡¨è¾¾å¼ï¼ˆexpression-basedï¼‰çš„è¯­è¨€ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªéœ€è¦ç†è§£çš„é‡è¦åŒºåˆ«ã€‚å…¶ä»–è¯­è¨€æ²¡æœ‰è¿™æ ·çš„åŒºåˆ«ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬çœ‹çœ‹è¯­å¥å’Œè¡¨è¾¾å¼åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Œä»¥åŠå®ƒä»¬çš„åŒºåˆ«å¦‚ä½•å½±å“å‡½æ•°ä½“ã€‚

**è¯­å¥**ï¼ˆ*statement*ï¼‰æ˜¯æ‰§è¡Œä¸€äº›æ“ä½œä½†ä¸è¿”å›å€¼çš„æŒ‡ä»¤ã€‚è¡¨è¾¾å¼ï¼ˆ*expression*ï¼‰è®¡ç®—å¹¶äº§ç”Ÿä¸€ä¸ªå€¼ã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨è¿‡è¯­å¥å’Œè¡¨è¾¾å¼äº†ï¼Œä½¿ç”¨ `let` å…³é”®å­—åˆ›å»ºå˜é‡å¹¶ç»‘å®šä¸€ä¸ªå€¼æ˜¯ä¸€ä¸ªè¯­å¥ã€‚ä¸‹é¢ç¤ºä¾‹ä¸­ï¼Œ`let y = 6;` æ˜¯ä¸€ä¸ªè¯­å¥ã€‚

```rust linenums="1" title="src/main.rs" hl_lines="2"
fn main() {
    let y = 6;
}
```

å‡½æ•°å®šä¹‰ä¹Ÿæ˜¯è¯­å¥ï¼Œä¸Šé¢æ•´ä¸ªä¾‹å­æœ¬èº«å°±æ˜¯ä¸€ä¸ªè¯­å¥ã€‚è¯­å¥ä¸è¿”å›å€¼ã€‚å› æ­¤ï¼Œä¸èƒ½æŠŠ `let` è¯­å¥èµ‹å€¼ç»™å¦ä¸€ä¸ªå˜é‡ï¼Œå°±åƒä¸‹é¢çš„ä»£ç å°è¯•åšçš„é‚£æ ·ï¼Œä¼šäº§ç”Ÿä¸€ä¸ªé”™è¯¯ï¼š

```rust title="src/main.rs"
fn main() {
    let x = (let y = 6);  // é”™è¯¯ä»£ç 
}
```

å½“è¿è¡Œè¿™ä¸ªç¨‹åºæ—¶ï¼Œä¼šå¾—åˆ°å¦‚ä¸‹é”™è¯¯ï¼š

```console
$ cargo run
   Compiling functions v0.1.0 (file:///projects/functions)
error: expected expression, found statement (`let`)
 --> src/main.rs:2:14
  |
2 |     let x = (let y = 6);
  |              ^^^^^^^^^
  |
  = note: variable declaration using `let` is a statement

error[E0658]: `let` expressions in this position are experimental
 --> src/main.rs:2:14
  |
2 |     let x = (let y = 6);
  |              ^^^^^^^^^
  |
  = note: see issue #53667 <https://github.com/rust-lang/rust/issues/53667> for more information
  = help: you can write `matches!(<expr>, <pattern>)` instead of `let <pattern> = <expr>`

warning: unnecessary parentheses around assigned value
 --> src/main.rs:2:13
  |
2 |     let x = (let y = 6);
  |             ^         ^
  |
  = note: `#[warn(unused_parens)]` on by default
help: remove these parentheses
  |
2 -     let x = (let y = 6);
2 +     let x = let y = 6;
  | 

For more information about this error, try `rustc --explain E0658`.
warning: `functions` (bin "functions") generated 1 warning
error: could not compile `functions` due to 2 previous errors; 1 warning emitted
```

`let y = 6` è¯­å¥å¹¶ä¸è¿”å›å€¼ï¼Œæ‰€ä»¥æ²¡æœ‰å¯ä»¥ç»‘å®šåˆ° `x` ä¸Šçš„å€¼ã€‚è¿™ä¸å…¶ä»–è¯­è¨€ä¸åŒï¼Œä¾‹å¦‚ C å’Œ Rubyï¼Œå®ƒä»¬çš„èµ‹å€¼è¯­å¥ä¼šè¿”å›æ‰€èµ‹çš„å€¼ã€‚åœ¨è¿™äº›è¯­è¨€ä¸­ï¼Œå¯ä»¥è¿™ä¹ˆå†™ `x = y = 6`ï¼Œè¿™æ · `x` å’Œ `y` çš„å€¼éƒ½æ˜¯ `6`ï¼›Rust ä¸­ä¸èƒ½è¿™æ ·å†™ã€‚

è¡¨è¾¾å¼ä¼šè®¡ç®—å‡ºä¸€ä¸ªå€¼ï¼Œå¹¶ä¸”ä½ æ¥ä¸‹æ¥è¦ç”¨ Rust ç¼–å†™çš„å¤§éƒ¨åˆ†ä»£ç éƒ½ç”±è¡¨è¾¾å¼ç»„æˆã€‚è€ƒè™‘ä¸€ä¸ªæ•°å­¦è¿ç®—ï¼Œæ¯”å¦‚ `5 + 6`ï¼Œè¿™æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼å¹¶è®¡ç®—å‡ºå€¼ `11`ã€‚è¡¨è¾¾å¼å¯ä»¥æ˜¯è¯­å¥çš„ä¸€éƒ¨åˆ†ï¼šåœ¨ç¤ºä¾‹ 3-1 ä¸­ï¼Œè¯­å¥ `let y = 6;` ä¸­çš„ `6` æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå®ƒè®¡ç®—å‡ºçš„å€¼æ˜¯ `6`ã€‚å‡½æ•°è°ƒç”¨æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚å®è°ƒç”¨æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚æˆ‘ä»¬ç”¨æ¥åˆ›å»ºæ–°ä½œç”¨åŸŸçš„å¤§æ‹¬å·ï¼ˆä»£ç å—ï¼‰ `{}` ä¹Ÿæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œä¾‹å¦‚ï¼š

```rust linenums="1" title="src/main.rs"
fn main() {
    let y = {
        let x = 3;
        x + 1
    };

    println!("The value of y is: {}", y);
}
```

è¿™ä¸ªè¡¨è¾¾å¼ï¼š

```rust linenums="1"
{
    let x = 3;
    x + 1
}
```

æ˜¯ä¸€ä¸ªä»£ç å—ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­è®¡ç®—ç»“æœæ˜¯ `4`ã€‚è¿™ä¸ªå€¼ä½œä¸º `let` è¯­å¥çš„ä¸€éƒ¨åˆ†è¢«ç»‘å®šåˆ° `y` ä¸Šã€‚æ³¨æ„ï¼Œ`x + 1` è¡Œçš„æœ«å°¾æ²¡æœ‰åˆ†å·ï¼Œè¿™ä¸ä½ ç›®å‰è§è¿‡çš„å¤§éƒ¨åˆ†ä»£ç è¡Œä¸åŒã€‚è¡¨è¾¾å¼çš„ç»“å°¾æ²¡æœ‰åˆ†å·ã€‚å¦‚æœåœ¨è¡¨è¾¾å¼çš„æœ«å°¾åŠ ä¸Šåˆ†å·ï¼Œé‚£ä¹ˆå®ƒå°±è½¬æ¢ä¸ºè¯­å¥ï¼Œè€Œè¯­å¥ä¸ä¼šè¿”å›å€¼ã€‚åœ¨æ¥ä¸‹æ¥æ¢è®¨å‡½æ•°è¿”å›å€¼å’Œè¡¨è¾¾å¼æ—¶ï¼Œè¯·è®°ä½è¿™ä¸€ç‚¹ã€‚

### 3.3 å¸¦æœ‰è¿”å›å€¼çš„å‡½æ•°

å‡½æ•°å¯ä»¥å‘è°ƒç”¨å®ƒçš„ä»£ç è¿”å›å€¼ã€‚æˆ‘ä»¬å¹¶ä¸å¯¹è¿”å›å€¼å‘½åï¼Œä½†è¦åœ¨ç®­å¤´ï¼ˆ`->`ï¼‰åå£°æ˜å®ƒçš„ç±»å‹ã€‚åœ¨ Rust ä¸­ï¼Œå‡½æ•°çš„è¿”å›å€¼ç­‰åŒäºå‡½æ•°ä½“æœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ã€‚ä½¿ç”¨ `return` å…³é”®å­—å’ŒæŒ‡å®šå€¼ï¼Œå¯ä»¥ä»å‡½æ•°ä¸­æå‰è¿”å›ï¼›ä½†å¤§éƒ¨åˆ†å‡½æ•°éšå¼è¿”å›æœ€åä¸€ä¸ªè¡¨è¾¾å¼ã€‚è¿™æ˜¯ä¸€ä¸ªæœ‰è¿”å›å€¼å‡½æ•°çš„ä¾‹å­ï¼š

```rust linenums="1" title="src/main.rs"
fn five() -> i32 {
    5
}

fn main() {
    let x = five();

    println!("The value of x is: {}", x);
}
```

åœ¨ `five` å‡½æ•°ä¸­æ²¡æœ‰å‡½æ•°è°ƒç”¨ã€å®ï¼Œç”šè‡³æ²¡æœ‰ `let` è¯­å¥â€”â€”åªæœ‰æ•°å­— `5` æœ¬èº«ã€‚è¿™åœ¨ Rust ä¸­æ˜¯ä¸€ä¸ªå®Œå…¨æœ‰æ•ˆçš„å‡½æ•°ã€‚æ³¨æ„ï¼Œå‡½æ•°è¿”å›å€¼çš„ç±»å‹ä¹Ÿè¢«æŒ‡å®šå¥½ï¼Œå³ `-> i32`ã€‚å°è¯•è¿è¡Œä»£ç ï¼›è¾“å‡ºåº”å¦‚ä¸‹æ‰€ç¤ºï¼š

```console
$ cargo run
   Compiling functions v0.1.0 (file:///projects/functions)
    Finished dev [unoptimized + debuginfo] target(s) in 0.30s
     Running `target/debug/functions`
The value of x is: 5
```

`five` å‡½æ•°çš„è¿”å›å€¼æ˜¯ `5`ï¼Œæ‰€ä»¥è¿”å›å€¼ç±»å‹æ˜¯ `i32`ã€‚è®©æˆ‘ä»¬ä»”ç»†æ£€æŸ¥ä¸€ä¸‹è¿™æ®µä»£ç ã€‚æœ‰ä¸¤ä¸ªé‡è¦çš„éƒ¨åˆ†ï¼šé¦–å…ˆï¼Œ`let x = five();` è¿™ä¸€è¡Œè¡¨æ˜æˆ‘ä»¬ä½¿ç”¨å‡½æ•°çš„è¿”å›å€¼åˆå§‹åŒ–ä¸€ä¸ªå˜é‡ã€‚å› ä¸º `five` å‡½æ•°è¿”å› `5`ï¼Œè¿™ä¸€è¡Œä¸å¦‚ä¸‹ä»£ç ç›¸åŒï¼š

```rust
let x = 5;
```

å…¶æ¬¡ï¼Œ`five` å‡½æ•°æ²¡æœ‰å‚æ•°å¹¶å®šä¹‰äº†è¿”å›å€¼ç±»å‹ï¼Œä¸è¿‡å‡½æ•°ä½“åªæœ‰å•å•ä¸€ä¸ª `5` ä¹Ÿæ²¡æœ‰åˆ†å·ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œæ­£æ˜¯æˆ‘ä»¬æƒ³è¦è¿”å›çš„å€¼ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹å¦ä¸€ä¸ªä¾‹å­ï¼š

```rust linenums="1" title="src/main.rs"
fn main() {
    let x = plus_one(5);

    println!("The value of x is: {}", x);
}

fn plus_one(x: i32) -> i32 {
    x + 1
}
```

è¿è¡Œä»£ç ä¼šæ‰“å°å‡º `The value of x is: 6`ã€‚==ä½†å¦‚æœåœ¨åŒ…å« `x + 1` çš„è¡Œå°¾åŠ ä¸Šä¸€ä¸ªåˆ†å·ï¼ŒæŠŠå®ƒä»è¡¨è¾¾å¼å˜æˆè¯­å¥==ï¼Œæˆ‘ä»¬å°†å¾—åˆ°ä¸€ä¸ªé”™è¯¯ã€‚

```rust linenums="1" title="src/main.rs"
fn main() {
    let x = plus_one(5);

    println!("The value of x is: {}", x);
}

fn plus_one(x: i32) -> i32 {
    x + 1;
}
```

è¿è¡Œä»£ç ä¼šäº§ç”Ÿä¸€ä¸ªé”™è¯¯ï¼Œå¦‚ä¸‹ï¼š

```console
$ cargo run
   Compiling functions v0.1.0 (file:///projects/functions)
error[E0308]: mismatched types
 --> src/main.rs:7:24
  |
7 | fn plus_one(x: i32) -> i32 {
  |    --------            ^^^ expected `i32`, found `()`
  |    |
  |    implicitly returns `()` as its body has no tail or `return` expression
8 |     x + 1;
  |          - help: consider removing this semicolon

For more information about this error, try `rustc --explain E0308`.
error: could not compile `functions` due to previous error
```

ä¸»è¦çš„é”™è¯¯ä¿¡æ¯ â€œmismatched typesâ€ï¼ˆç±»å‹ä¸åŒ¹é…ï¼‰æ­ç¤ºäº†è¿™æ®µä»£ç çš„æ ¸å¿ƒé—®é¢˜ã€‚å‡½æ•° `plus_one` çš„å®šä¹‰è¯´æ˜å®ƒè¦è¿”å›ä¸€ä¸ª `i32` ç±»å‹çš„å€¼ï¼Œä¸è¿‡è¯­å¥å¹¶ä¸ä¼šè¿”å›å€¼ï¼Œæ­¤å€¼ç”±å•å…ƒç±»å‹ `()` è¡¨ç¤ºï¼Œè¡¨ç¤ºä¸è¿”å›å€¼ã€‚å› ä¸ºä¸è¿”å›å€¼ä¸å‡½æ•°å®šä¹‰ç›¸çŸ›ç›¾ï¼Œä»è€Œå‡ºç°ä¸€ä¸ªé”™è¯¯ã€‚åœ¨è¾“å‡ºä¸­ï¼ŒRust æä¾›äº†ä¸€æ¡ä¿¡æ¯ï¼Œå¯èƒ½æœ‰åŠ©äºçº æ­£è¿™ä¸ªé”™è¯¯ï¼šå®ƒå»ºè®®åˆ é™¤åˆ†å·ï¼Œè¿™å°†ä¿®å¤é”™è¯¯ã€‚

## 4. æ³¨é‡Š

æ‰€æœ‰çš„å¼€å‘è€…éƒ½åœ¨åŠªåŠ›ä½¿ä»–ä»¬çš„ä»£ç å®¹æ˜“ç†è§£ï¼Œä½†æœ‰æ—¶éœ€è¦é¢å¤–çš„è§£é‡Šã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¼€å‘è€…åœ¨ä»–ä»¬çš„æºç ä¸­ç•™ä¸‹**æ³¨é‡Š**ï¼Œç¼–è¯‘å™¨å°†ä¼šå¿½ç•¥æ‰è¿™äº›å†…å®¹ï¼Œä½†é˜…è¯»æºç çš„äººå¯èƒ½ä¼šå‘ç°æœ‰ç”¨ã€‚

è¿™æ˜¯ä¸€æ¡ç®€å•çš„æ³¨é‡Šï¼š

```rust
// Hello, world.
```

åœ¨ Rust ä¸­ï¼Œæƒ¯ç”¨çš„æ³¨é‡Šå½¢å¼ä»¥ä¸¤ä¸ªæ–œæ†å¼€å¤´ï¼Œç›´åˆ°è¯¥è¡Œå°¾ç»“æŸã€‚å¯¹äºè¶…å‡ºå•è¡Œçš„æ³¨é‡Šï¼Œéœ€è¦åœ¨æ¯è¡Œçš„è¡Œé¦–åŠ ä¸Š `//`ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```rust
// æˆ‘ä»¬åœ¨è¿™é‡Œå¤„ç†ä¸€äº›å¤æ‚äº‹æƒ…ï¼Œéœ€è¦è¶³å¤Ÿé•¿çš„è§£é‡Šï¼Œä½¿ç”¨
// å¤šè¡Œæ³¨é‡Šå¯åšåˆ°è¿™ç‚¹ã€‚å“‡ï¼æˆ‘ä»¬å¸Œæœ›è¿™ä¸ªæ³¨é‡Šå°†è§£é‡Šæ¥ä¸‹
// æ¥è¦å®ç°çš„å†…å®¹ã€‚
```

æ³¨é‡Šä¹Ÿå¯ä»¥æ”¾åœ¨åŒ…å«ä»£ç çš„è¡Œåé¢ï¼š

```rust title="src/main.rs" hl_lines="2" linenums="1"
fn main() {
    let lucky_number = 7; // Iâ€™m feeling lucky today
}
```

ä¸è¿‡ä¸‹é¢çš„è¿™ç§æ ¼å¼ä¼šæ›´å¸¸è§ï¼Œå°†æ³¨é‡Šæ”¾åˆ°éœ€è¦è§£é‡Šçš„ä»£ç ä¸Šé¢çš„å•ç‹¬è¡Œï¼š

```rust linenums="1" title="src/main.rs"
fn main() {
    // Iâ€™m feeling lucky today
    let lucky_number = 7;
}
```

Rust è¿˜å…·æœ‰å¦ä¸€ç§æ³¨é‡Šï¼Œå³æ–‡æ¡£æ³¨é‡Šï¼Œæˆ‘ä»¬å°†åœ¨ç¬¬ 14 ç« çš„ â€œå°† crate å‘å¸ƒåˆ° Crates.ioâ€ ç« èŠ‚ä¸­è¿›è¡Œè®¨è®ºã€‚

## 5. æ§åˆ¶æµ

æ ¹æ®æ¡ä»¶æ˜¯å¦ä¸ºçœŸæ¥å†³å®šæ˜¯å¦æ‰§è¡ŒæŸäº›ä»£ç ï¼Œæˆ–æ ¹æ®æ¡ä»¶æ˜¯å¦ä¸ºçœŸæ¥é‡å¤è¿è¡Œä¸€æ®µä»£ç ï¼Œæ˜¯å¤§éƒ¨åˆ†ç¼–ç¨‹è¯­è¨€çš„åŸºæœ¬ç»„æˆéƒ¨åˆ†ã€‚Rust ä»£ç ä¸­æœ€å¸¸è§çš„ç”¨æ¥æ§åˆ¶æ‰§è¡Œæµçš„ç»“æ„æ˜¯ `if` è¡¨è¾¾å¼å’Œå¾ªç¯ã€‚

### 5.1 `if` è¡¨è¾¾å¼

`if` è¡¨è¾¾å¼å…è®¸æ ¹æ®æ¡ä»¶æ‰§è¡Œä¸åŒçš„ä»£ç åˆ†æ”¯ã€‚ä½ æä¾›ä¸€ä¸ªæ¡ä»¶å¹¶è¡¨ç¤º â€œå¦‚æœæ¡ä»¶æ»¡è¶³ï¼Œè¿è¡Œè¿™æ®µä»£ç ï¼›å¦‚æœæ¡ä»¶ä¸æ»¡è¶³ï¼Œä¸è¿è¡Œè¿™æ®µä»£ç ã€‚â€

åœ¨ *projects* ç›®å½•æ–°å»ºä¸€ä¸ªåä¸º *branches* çš„é¡¹ç›®ç”¨æ¥å­¦ä¹  `if` è¡¨è¾¾å¼ã€‚åœ¨ *src/main.rs* æ–‡ä»¶ä¸­ï¼Œè¾“å…¥å¦‚ä¸‹å†…å®¹ï¼š

```rust linenums="1" title="src/main.rs"
fn main() {
    let number = 3;

    if number < 5 {
        println!("condition was true");
    } else {
        println!("condition was false");
    }
}
```

æ‰€æœ‰çš„ `if` è¡¨è¾¾å¼éƒ½ä»¥ `if` å…³é”®å­—å¼€å¤´ï¼Œå…¶åè·Ÿä¸€ä¸ªæ¡ä»¶ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ¡ä»¶æ£€æŸ¥å˜é‡ `number` çš„å€¼æ˜¯å¦å°äº 5ã€‚åœ¨æ¡ä»¶ä¸ºçœŸæ—¶å¸Œæœ›æ‰§è¡Œçš„ä»£ç å—ä½äºç´§è·Ÿæ¡ä»¶ä¹‹åçš„å¤§æ‹¬å·ä¸­ã€‚`if` è¡¨è¾¾å¼ä¸­ä¸æ¡ä»¶å…³è”çš„ä»£ç å—æœ‰æ—¶è¢«å«åš**åˆ†æ”¯**ï¼ˆ*arm*ï¼‰ï¼Œå°±åƒç¬¬ 2 ç« [â€œæ¯”è¾ƒçŒœæµ‹çš„æ•°å­—å’Œç§˜å¯†æ•°å­—â€](https://rustwiki.org/zh-CN/book/ch02-00-guessing-game-tutorial.html#æ¯”è¾ƒçŒœæµ‹çš„æ•°å­—å’Œç§˜å¯†æ•°å­—)éƒ¨åˆ†ä¸­è®¨è®ºåˆ°çš„ `match` è¡¨è¾¾å¼ä¸­çš„åˆ†æ”¯ä¸€æ ·ã€‚

ä¹Ÿå¯ä»¥åŒ…å«ä¸€ä¸ªå¯é€‰çš„ `else` è¡¨è¾¾å¼æ¥æä¾›ä¸€ä¸ªåœ¨æ¡ä»¶ä¸ºå‡æ—¶åº”å½“æ‰§è¡Œçš„ä»£ç å—ï¼Œè¿™é‡Œæˆ‘ä»¬å°±è¿™ä¹ˆåšäº†ã€‚å¦‚æœä¸æä¾› `else` è¡¨è¾¾å¼å¹¶ä¸”æ¡ä»¶ä¸ºå‡æ—¶ï¼Œç¨‹åºä¼šç›´æ¥å¿½ç•¥ `if` ä»£ç å—å¹¶ç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç ã€‚

å°è¯•è¿è¡Œä»£ç ï¼Œåº”è¯¥èƒ½çœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼š

```console
$ cargo run
   Compiling branches v0.1.0 (file:///projects/branches)
    Finished dev [unoptimized + debuginfo] target(s) in 0.31s
     Running `target/debug/branches`
condition was true
```

å°è¯•æ”¹å˜ `number` çš„å€¼ä½¿æ¡ä»¶ä¸º `false` æ—¶çœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼š

```rust
let number = 7;
```

å†æ¬¡è¿è¡Œç¨‹åºå¹¶æŸ¥çœ‹è¾“å‡ºï¼š

```console
$ cargo run
   Compiling branches v0.1.0 (file:///projects/branches)
    Finished dev [unoptimized + debuginfo] target(s) in 0.31s
     Running `target/debug/branches`
condition was false
```

å¦å¤–å€¼å¾—æ³¨æ„çš„æ˜¯ä»£ç ä¸­çš„æ¡ä»¶ **å¿…é¡»** æ˜¯ `bool` å€¼ã€‚å¦‚æœæ¡ä»¶ä¸æ˜¯ `bool` å€¼ï¼Œæˆ‘ä»¬å°†å¾—åˆ°ä¸€ä¸ªé”™è¯¯ã€‚ä¾‹å¦‚ï¼Œå°è¯•è¿è¡Œä»¥ä¸‹ä»£ç ï¼š


```rust title="src/main.rs" linenums="1"
fn main() {
    let number = 3;

    if number {
        println!("number was three");
    }
}
```

è¿™é‡Œ `if` æ¡ä»¶çš„å€¼æ˜¯ `3`ï¼ŒRust æŠ›å‡ºäº†ä¸€ä¸ªé”™è¯¯ï¼š

```console
$ cargo run
   Compiling branches v0.1.0 (file:///projects/branches)
error[E0308]: mismatched types
 --> src/main.rs:4:8
  |
4 |     if number {
  |        ^^^^^^ expected `bool`, found integer

For more information about this error, try `rustc --explain E0308`.
error: could not compile `branches` due to previous error
```

è¿™ä¸ªé”™è¯¯è¡¨æ˜ Rust æœŸæœ›ä¸€ä¸ª `bool` å´å¾—åˆ°äº†ä¸€ä¸ªæ•´æ•°ã€‚ä¸åƒ Ruby æˆ– JavaScript è¿™æ ·çš„è¯­è¨€ï¼ŒRust å¹¶ä¸ä¼šå°è¯•è‡ªåŠ¨åœ°å°†éå¸ƒå°”å€¼è½¬æ¢ä¸ºå¸ƒå°”å€¼ã€‚ä½ å¿…é¡»è‡ªå§‹è‡³ç»ˆæ˜¾å¼åœ°ä½¿ç”¨å¸ƒå°”å€¼ä½œä¸º `if` çš„æ¡ä»¶ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæƒ³è¦ `if` ä»£ç å—åªåœ¨ä¸€ä¸ªæ•°å­—ä¸ç­‰äº `0` æ—¶æ‰§è¡Œï¼Œå¯ä»¥æŠŠ `if` è¡¨è¾¾å¼ä¿®æ”¹æˆä¸‹é¢è¿™æ ·ï¼š

```rust linenums="1" title="src/main.rs"
fn main() {
    let number = 3;

    if number != 0 {
        println!("number was something other than zero");
    }
}
```

è¿è¡Œä»£ç ä¼šæ‰“å°å‡º `number was something other than zero`ã€‚

#### 5.1.1 ä½¿ç”¨ `else if` å¤„ç†å¤šé‡æ¡ä»¶

å¯ä»¥å°† `if` å’Œ `else` ç»„æˆçš„ `else if` è¡¨è¾¾å¼æ¥å®ç°å¤šé‡æ¡ä»¶ã€‚ä¾‹å¦‚ï¼š

```rust linenums="1" title="src/main.rs"
fn main() {
    let number = 6;

    if number % 4 == 0 {
        println!("number is divisible by 4");
    } else if number % 3 == 0 {
        println!("number is divisible by 3");
    } else if number % 2 == 0 {
        println!("number is divisible by 2");
    } else {
        println!("number is not divisible by 4, 3, or 2");
    }
}
```

è¿™ä¸ªç¨‹åºæœ‰ 4 ä¸ªå¯èƒ½çš„æ‰§è¡Œè·¯å¾„ã€‚è¿è¡Œååº”è¯¥èƒ½çœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼š

```console
$ cargo run
   Compiling branches v0.1.0 (file:///projects/branches)
    Finished dev [unoptimized + debuginfo] target(s) in 0.31s
     Running `target/debug/branches`
number is divisible by 3
```

å½“æ‰§è¡Œè¿™ä¸ªç¨‹åºæ—¶ï¼Œå®ƒæŒ‰é¡ºåºæ£€æŸ¥æ¯ä¸ª `if` è¡¨è¾¾å¼å¹¶æ‰§è¡Œç¬¬ä¸€ä¸ªæ¡ä»¶ä¸ºçœŸçš„ä»£ç å—ã€‚æ³¨æ„å³ä½¿ 6 å¯ä»¥è¢« 2 æ•´é™¤ï¼Œä¹Ÿä¸ä¼šè¾“å‡º `number is divisible by 2`ï¼Œæ›´ä¸ä¼šè¾“å‡º `else` å—ä¸­çš„ `number is not divisible by 4, 3, or 2`ã€‚åŸå› æ˜¯ Rust åªä¼šæ‰§è¡Œç¬¬ä¸€ä¸ªæ¡ä»¶ä¸ºçœŸçš„ä»£ç å—ï¼Œå¹¶ä¸”ä¸€æ—¦å®ƒæ‰¾åˆ°ä¸€ä¸ªä»¥åï¼Œç”šè‡³éƒ½ä¸ä¼šæ£€æŸ¥å‰©ä¸‹çš„æ¡ä»¶äº†ã€‚

ä½¿ç”¨è¿‡å¤šçš„ `else if` è¡¨è¾¾å¼ä¼šä½¿ä»£ç æ˜¾å¾—æ‚ä¹±æ— ç« ï¼Œæ‰€ä»¥å¦‚æœæœ‰å¤šäºä¸€ä¸ª `else if` è¡¨è¾¾å¼ï¼Œæœ€å¥½é‡æ„ä»£ç ã€‚ä¸ºå¤„ç†è¿™äº›æƒ…å†µï¼Œç¬¬ 6 ç« ä¼šä»‹ç»ä¸€ä¸ªå¼ºå¤§çš„ Rust åˆ†æ”¯ç»“æ„ï¼ˆbranching constructï¼‰ï¼Œå«åš `match`ã€‚

#### 5.1.2 åœ¨ `let` è¯­å¥ä¸­ä½¿ç”¨ `if`

å› ä¸º `if` æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ `let` è¯­å¥çš„å³ä¾§ä½¿ç”¨å®ƒæ¥å°†ç»“æœèµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ï¼Œä¾‹å¦‚åœ¨å¦‚ä¸‹ç¤ºä¾‹ä¸­ï¼š

```rust linenums="1" title="src/main.rs"
fn main() {
    let condition = true;
    let number = if condition { 5 } else { 6 };

    println!("The value of number is: {}", number);
}
```

`number` å˜é‡å°†ä¼šç»‘å®šåˆ°è¡¨ç¤º `if` è¡¨è¾¾å¼ç»“æœçš„å€¼ä¸Šã€‚è¿è¡Œè¿™æ®µä»£ç çœ‹çœ‹ä¼šå‡ºç°ä»€ä¹ˆï¼š

```console
$ cargo run
   Compiling branches v0.1.0 (file:///projects/branches)
    Finished dev [unoptimized + debuginfo] target(s) in 0.30s
     Running `target/debug/branches`
The value of number is: 5
```

è®°ä½ï¼Œä»£ç å—çš„å€¼æ˜¯å…¶æœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼Œè€Œæ•°å­—æœ¬èº«å°±æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ•´ä¸ª `if` è¡¨è¾¾å¼çš„å€¼å–å†³äºå“ªä¸ªä»£ç å—è¢«æ‰§è¡Œã€‚è¿™æ„å‘³ç€ `if` çš„æ¯ä¸ªåˆ†æ”¯çš„å¯èƒ½çš„è¿”å›å€¼éƒ½å¿…é¡»æ˜¯ç›¸åŒç±»å‹ï¼›åœ¨ç¤ºä¾‹ 3-2 ä¸­ï¼Œ`if` åˆ†æ”¯å’Œ `else` åˆ†æ”¯çš„ç»“æœéƒ½æ˜¯ `i32` æ•´å‹ã€‚å¦‚æœå®ƒä»¬çš„ç±»å‹ä¸åŒ¹é…ï¼Œå¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œåˆ™ä¼šäº§ç”Ÿä¸€ä¸ªé”™è¯¯ï¼š

```rust title="src/main.rs" linenums="1"
fn main() {
    let condition = true;

    let number = if condition { 5 } else { "six" };

    println!("The value of number is: {}", number);
}
```

å½“ç¼–è¯‘è¿™æ®µä»£ç æ—¶ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªé”™è¯¯ã€‚`if` å’Œ `else` åˆ†æ”¯çš„å€¼ç±»å‹æ˜¯ä¸ç›¸å®¹çš„ï¼ŒåŒæ—¶ Rust ä¹Ÿå‡†ç¡®åœ°æŒ‡å‡ºåœ¨ç¨‹åºä¸­çš„ä½•å¤„å‘ç°çš„è¿™ä¸ªé—®é¢˜ï¼š

```console
$ cargo run
   Compiling branches v0.1.0 (file:///projects/branches)
error[E0308]: `if` and `else` have incompatible types
 --> src/main.rs:4:44
  |
4 |     let number = if condition { 5 } else { "six" };
  |                                 -          ^^^^^ expected integer, found `&str`
  |                                 |
  |                                 expected because of this

For more information about this error, try `rustc --explain E0308`.
error: could not compile `branches` due to previous error
```

`if` ä»£ç å—ä¸­çš„è¡¨è¾¾å¼è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œè€Œ `else` ä»£ç å—ä¸­çš„è¡¨è¾¾å¼è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚è¿™ä¸å¯è¡Œï¼Œå› ä¸ºå˜é‡å¿…é¡»åªæœ‰ä¸€ä¸ªç±»å‹ã€‚Rust éœ€è¦åœ¨ç¼–è¯‘æ—¶å°±ç¡®åˆ‡åœ°çŸ¥é“ `number` å˜é‡çš„ç±»å‹ï¼Œè¿™æ ·å®ƒå°±å¯ä»¥åœ¨ç¼–è¯‘æ—¶éªŒè¯åœ¨æ¯å¤„ä½¿ç”¨çš„ `number` å˜é‡çš„ç±»å‹æ˜¯æœ‰æ•ˆçš„ã€‚è‹¥ `number` çš„ç±»å‹ä»…åœ¨è¿è¡Œæ—¶ç¡®å®šï¼Œåˆ™ Rust å°†æ— æ³•åšåˆ°è¿™ä¸€ç‚¹ï¼›è€Œä¸”è‹¥ç¼–è¯‘å™¨å¿…é¡»è·Ÿè¸ªä»»æ„å˜é‡çš„å¤šç§å‡è®¾ç±»å‹ï¼Œåˆ™ç¼–è¯‘å™¨ä¼šå˜å¾—æ›´å¤æ‚ï¼Œå¹¶ä¸”å¯¹ä»£ç çš„ä¿è¯ä¹Ÿä¼šå‡å°‘ã€‚

### 5.2 ä½¿ç”¨å¾ªç¯é‡å¤æ‰§è¡Œ

å¤šæ¬¡æ‰§è¡ŒåŒä¸€æ®µä»£ç æ˜¯å¾ˆå¸¸ç”¨çš„ï¼ŒRust ä¸ºæ­¤æä¾›äº†å¤šç§**å¾ªç¯**ï¼ˆ*loop*ï¼‰ï¼Œå®ƒä»¬éå†æ‰§è¡Œå¾ªç¯ä½“ä¸­çš„ä»£ç ç›´åˆ°ç»“å°¾å¹¶ç´§æ¥ç€å›åˆ°å¼€å¤´ç»§ç»­æ‰§è¡Œã€‚ä¸ºäº†è¯•éªŒå¾ªç¯ï¼Œè®©æˆ‘ä»¬æ–°å»ºä¸€ä¸ªåä¸º *loops* çš„é¡¹ç›®ã€‚

Rust æœ‰ä¸‰ç§å¾ªç¯ï¼š`loop`ã€`while` å’Œ `for`ã€‚æˆ‘ä»¬æ¯ä¸€ä¸ªéƒ½è¯•è¯•ã€‚

#### 5.2.1 ä½¿ç”¨ `loop` é‡å¤æ‰§è¡Œä»£ç 

`loop` å…³é”®å­—å‘Šè¯‰ Rust ä¸€éåˆä¸€éåœ°æ‰§è¡Œä¸€æ®µä»£ç ç›´åˆ°ä½ æ˜ç¡®è¦æ±‚åœæ­¢ã€‚

ä¾‹å¦‚ï¼Œå°† *loops* ç›®å½•ä¸­çš„ *src/main.rs* æ–‡ä»¶ä¿®æ”¹ä¸ºå¦‚ä¸‹ï¼š

```rust linenums="1" title="src/main.rs"
fn main() {
    loop {
        println!("again!");
    }
}
```

å½“è¿è¡Œè¿™ä¸ªç¨‹åºæ—¶ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°è¿ç»­çš„åå¤æ‰“å° `again!`ï¼Œç›´åˆ°æˆ‘ä»¬æ‰‹åŠ¨åœæ­¢ç¨‹åºã€‚å¤§éƒ¨åˆ†ç»ˆç«¯éƒ½æ”¯æŒä¸€ä¸ªå¿«æ·é”® ctrl-c æ¥ç»ˆæ­¢ä¸€ä¸ªé™·å…¥æ— é™å¾ªç¯çš„ç¨‹åºã€‚å°è¯•ä¸€ä¸‹ï¼š

```console
$ cargo run
   Compiling loops v0.1.0 (file:///projects/loops)
    Finished dev [unoptimized + debuginfo] target(s) in 0.29s
     Running `target/debug/loops`
again!
again!
again!
again!
^Cagain!
```

ç¬¦å· `^C` ä»£è¡¨ä½ åœ¨è¿™æŒ‰ä¸‹äº†ctrl-cã€‚åœ¨ `^C` ä¹‹åä½ å¯èƒ½çœ‹åˆ°ä¹Ÿå¯èƒ½çœ‹ä¸åˆ° `again!` ï¼Œè¿™å–å†³äºåœ¨æ¥æ”¶åˆ°ç»ˆæ­¢ä¿¡å·æ—¶ä»£ç æ‰§è¡Œåˆ°äº†å¾ªç¯çš„ä½•å¤„ã€‚

å¹¸è¿çš„æ˜¯ï¼ŒRust ä¹Ÿæä¾›äº†ä¸€ç§ä»ä»£ç ä¸­è·³å‡ºå¾ªç¯çš„æ–¹æ³•ã€‚å¯ä»¥ä½¿ç”¨ `break` å…³é”®å­—æ¥å‘Šè¯‰ç¨‹åºä½•æ—¶åœæ­¢å¾ªç¯ã€‚å›å¿†ä¸€ä¸‹åœ¨ç¬¬ 2 ç« çŒœæ•°å­—æ¸¸æˆçš„ [â€œçŒœæµ‹æ­£ç¡®åé€€å‡ºâ€](https://rustwiki.org/zh-CN/book/ch02-00-guessing-game-tutorial.html#çŒœæµ‹æ­£ç¡®åé€€å‡º) ç« èŠ‚ä½¿ç”¨è¿‡å®ƒæ¥åœ¨ç”¨æˆ·çŒœå¯¹æ•°å­—èµ¢å¾—æ¸¸æˆåé€€å‡ºç¨‹åºã€‚

æˆ‘ä»¬åœ¨çŒœæ•°å­—æ¸¸æˆä¸­ä¹Ÿä½¿ç”¨äº† `continue`ã€‚å¾ªç¯ä¸­çš„ `continue` å…³é”®å­—å‘Šè¯‰ç¨‹åºè·³è¿‡è¿™ä¸ªå¾ªç¯è¿­ä»£ä¸­çš„ä»»ä½•å‰©ä½™ä»£ç ï¼Œå¹¶è½¬åˆ°ä¸‹ä¸€ä¸ªè¿­ä»£ã€‚

å¦‚æœå­˜åœ¨åµŒå¥—å¾ªç¯ï¼Œ`break` å’Œ `continue` åº”ç”¨äºæ­¤æ—¶æœ€å†…å±‚çš„å¾ªç¯ã€‚ä½ å¯ä»¥é€‰æ‹©åœ¨ä¸€ä¸ªå¾ªç¯ä¸ŠæŒ‡å®šä¸€ä¸ª**å¾ªç¯æ ‡ç­¾**ï¼ˆ*loop label*ï¼‰ï¼Œç„¶åå°†æ ‡ç­¾ä¸ `break` æˆ– `continue` ä¸€èµ·ä½¿ç”¨ï¼Œä½¿è¿™äº›å…³é”®å­—åº”ç”¨äºå·²æ ‡è®°çš„å¾ªç¯è€Œä¸æ˜¯æœ€å†…å±‚çš„å¾ªç¯ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªåµŒå¥—å¾ªç¯çš„ç¤ºä¾‹ï¼š

```rust linenums="1" title="src/main.rs"
fn main() {
    let mut count = 0;
    'counting_up: loop {
        println!("count = {}", count);
        let mut remaining = 10;

        loop {
            println!("remaining = {}", remaining);
            if remaining == 9 {
                break;
            }
            if count == 2 {
                break 'counting_up;
            }
            remaining -= 1;
        }

        count += 1;
    }
    println!("End count = {}", count);
}
```

å¤–å±‚å¾ªç¯æœ‰ä¸€ä¸ªæ ‡ç­¾ `counting_up`ï¼Œå®ƒå°†ä» 0 æ•°åˆ° 2ã€‚æ²¡æœ‰æ ‡ç­¾çš„å†…éƒ¨å¾ªç¯ä» 10 å‘ä¸‹æ•°åˆ° 9ã€‚ç¬¬ä¸€ä¸ªæ²¡æœ‰æŒ‡å®šæ ‡ç­¾çš„ `break` å°†åªé€€å‡ºå†…å±‚å¾ªç¯ã€‚`break 'counting_up;` è¯­å¥å°†é€€å‡ºå¤–å±‚å¾ªç¯ã€‚è¿™ä¸ªä»£ç æ‰“å°:

```console
$ cargo run
   Compiling loops v0.1.0 (file:///projects/loops)
    Finished dev [unoptimized + debuginfo] target(s) in 0.58s
     Running `target/debug/loops`
count = 0
remaining = 10
remaining = 9
count = 1
remaining = 10
remaining = 9
count = 2
remaining = 10
End count = 2
```

#### 5.2.2 ä»å¾ªç¯è¿”å›

`loop` çš„ä¸€ä¸ªç”¨ä¾‹æ˜¯é‡è¯•å¯èƒ½ä¼šå¤±è´¥çš„æ“ä½œï¼Œæ¯”å¦‚æ£€æŸ¥çº¿ç¨‹æ˜¯å¦å®Œæˆäº†ä»»åŠ¡ã€‚ç„¶è€Œä½ å¯èƒ½ä¼šéœ€è¦å°†æ“ä½œçš„ç»“æœä»å¾ªç¯ä¸­ä¼ é€’ç»™å…¶å®ƒçš„ä»£ç ã€‚ä¸ºæ­¤ï¼Œä½ å¯ä»¥åœ¨ç”¨äºåœæ­¢å¾ªç¯çš„ `break` è¡¨è¾¾å¼æ·»åŠ ä½ æƒ³è¦è¿”å›çš„å€¼ï¼›è¯¥å€¼å°†ä»å¾ªç¯ä¸­è¿”å›ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥ä½¿ç”¨å®ƒï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```rust
fn main() {
    let mut counter = 0;

    let result = loop {
        counter += 1;

        if counter == 10 {
            break counter * 2;
        }
    };

    println!("The result is {}", result);
}
```

åœ¨å¾ªç¯ä¹‹å‰ï¼Œæˆ‘ä»¬å£°æ˜äº†ä¸€ä¸ªåä¸º `counter` çš„å˜é‡å¹¶åˆå§‹åŒ–ä¸º `0`ã€‚æ¥ç€å£°æ˜äº†ä¸€ä¸ªåä¸º `result` æ¥å­˜æ”¾å¾ªç¯çš„è¿”å›å€¼ã€‚åœ¨å¾ªç¯çš„æ¯ä¸€æ¬¡è¿­ä»£ä¸­ï¼Œæˆ‘ä»¬å°† `counter` å˜é‡åŠ  `1`ï¼Œæ¥ç€æ£€æŸ¥è®¡æ•°æ˜¯å¦ç­‰äº `10`ã€‚å½“ç›¸ç­‰æ—¶ï¼Œä½¿ç”¨ `break` å…³é”®å­—è¿”å›å€¼ `counter * 2`ã€‚å¾ªç¯ä¹‹åï¼Œæˆ‘ä»¬é€šè¿‡åˆ†å·ç»“æŸèµ‹å€¼ç»™ `result` çš„è¯­å¥ã€‚æœ€åæ‰“å°å‡º `result` çš„å€¼ï¼Œä¹Ÿå°±æ˜¯ 20ã€‚

#### 5.2.3 `while` æ¡ä»¶å¾ªç¯

åœ¨ç¨‹åºä¸­è®¡ç®—å¾ªç¯çš„æ¡ä»¶ä¹Ÿå¾ˆå¸¸è§ã€‚å½“æ¡ä»¶ä¸ºçœŸï¼Œæ‰§è¡Œå¾ªç¯ã€‚å½“æ¡ä»¶ä¸å†ä¸ºçœŸï¼Œè°ƒç”¨ `break` åœæ­¢å¾ªç¯ã€‚è¿™ä¸ªå¾ªç¯ç±»å‹å¯ä»¥é€šè¿‡ç»„åˆ `loop`ã€`if`ã€`else` å’Œ `break` æ¥å®ç°ï¼›å¦‚æœä½ å–œæ¬¢çš„è¯ï¼Œç°åœ¨å°±å¯ä»¥åœ¨ç¨‹åºä¸­è¯•è¯•ã€‚ç„¶è€Œï¼Œè¿™ä¸ªæ¨¡å¼å¤ªå¸¸ç”¨äº†ï¼ŒRust ä¸ºæ­¤å†…ç½®äº†ä¸€ä¸ªè¯­è¨€ç»“æ„ï¼Œå®ƒè¢«ç§°ä¸º `while` å¾ªç¯ã€‚ç¤ºä¾‹ 3-3 ä½¿ç”¨äº† `while` æ¥ç¨‹åºå¾ªç¯ 3 æ¬¡ï¼Œæ¯æ¬¡æ•°å­—éƒ½å‡ 1ã€‚æ¥ç€åœ¨å¾ªç¯ç»“æŸåï¼Œæ‰“å°å‡ºå¦ä¸€ä¸ªä¿¡æ¯å¹¶é€€å‡ºã€‚


```rust title="src/main.rs" linenums="1"
fn main() {
    let mut number = 3;

    while number != 0 {
        println!("{}!", number);

        number -= 1;
    }

    println!("LIFTOFF!!!");
}
```

ç¤ºä¾‹ 3-3: å½“æ¡ä»¶ä¸ºçœŸæ—¶ï¼Œä½¿ç”¨ `while` å¾ªç¯è¿è¡Œä»£ç 

è¿™ç§ç»“æ„æ¶ˆé™¤äº†å¾ˆå¤šä½¿ç”¨ `loop`ã€`if`ã€`else` å’Œ `break` æ—¶æ‰€å¿…é¡»çš„åµŒå¥—ï¼Œè¿™æ ·æ›´åŠ æ¸…æ™°ã€‚å½“æ¡ä»¶ä¸ºçœŸå°±æ‰§è¡Œï¼Œå¦åˆ™é€€å‡ºå¾ªç¯ã€‚

#### 5.2.4 ä½¿ç”¨ `for` éå†é›†åˆ

å¯ä»¥ä½¿ç”¨ `while` ç»“æ„æ¥éå†é›†åˆä¸­çš„å…ƒç´ ï¼Œæ¯”å¦‚æ•°ç»„ã€‚ä¾‹å¦‚ï¼Œç¤ºä¾‹ 3-4 ä¸­çš„å¾ªç¯æ‰“å°æ•°ç»„ `a` ä¸­çš„æ¯ä¸ªå…ƒç´ ã€‚

```rust linenums="1" title="src/main.rs"
fn main() {
    let a = [10, 20, 30, 40, 50];
    let mut index = 0;

    while index < 5 {
        println!("the value is: {}", a[index]);

        index += 1;
    }
}
```

åœ¨è¿™é‡Œï¼Œä»£ç å¯¹æ•°ç»„ä¸­çš„å…ƒç´ è¿›è¡Œè®¡æ•°ã€‚å®ƒä»ç´¢å¼• `0` å¼€å§‹ï¼Œå¹¶æ¥ç€å¾ªç¯ç›´åˆ°é‡åˆ°æ•°ç»„çš„æœ€åä¸€ä¸ªç´¢å¼•ï¼ˆå³ `index < 5` ä¸å†ä¸ºçœŸæ—¶ï¼‰ã€‚è¿è¡Œè¿™æ®µä»£ç ä¼šæ‰“å°å‡ºæ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼š

```console
$ cargo run
   Compiling loops v0.1.0 (file:///projects/loops)
    Finished dev [unoptimized + debuginfo] target(s) in 0.32s
     Running `target/debug/loops`
the value is: 10
the value is: 20
the value is: 30
the value is: 40
the value is: 50
```

æ•°ç»„ä¸­çš„ 5 ä¸ªå…ƒç´ å…¨éƒ¨éƒ½å¦‚æœŸè¢«æ‰“å°å‡ºæ¥ã€‚å°½ç®¡ `index` åœ¨æŸä¸€æ—¶åˆ»ä¼šåˆ°è¾¾å€¼ `5`ï¼Œä¸è¿‡å¾ªç¯åœ¨å…¶å°è¯•ä»æ•°ç»„è·å–ç¬¬ 6 ä¸ªå€¼ï¼ˆä¼šè¶Šç•Œï¼‰ä¹‹å‰å°±åœæ­¢äº†ã€‚

ä½†æ˜¯è¿™ä¸ªè¿‡ç¨‹å¾ˆå®¹æ˜“å‡ºé”™ï¼›å¦‚æœç´¢å¼•å€¼æˆ–æµ‹è¯•æ¡ä»¶ä¸æ­£ç¡®ä¼šå¯¼è‡´ç¨‹åº panicã€‚ä¾‹å¦‚ï¼Œå¦‚æœå°† `a` æ•°ç»„çš„å®šä¹‰æ›´æ”¹ä¸ºåŒ…å« 4 ä¸ªå…ƒç´ ï¼Œä½†å¿˜è®°å°†æ¡ä»¶æ›´æ–°ä¸º`while index < 4`ï¼Œåˆ™ä»£ç ä¼šå‡ºç° panicã€‚è¿™ä¹Ÿä½¿ç¨‹åºæ›´æ…¢ï¼Œå› ä¸ºç¼–è¯‘å™¨å¢åŠ äº†è¿è¡Œæ—¶ä»£ç æ¥å¯¹æ¯æ¬¡å¾ªç¯è¿›è¡Œæ¡ä»¶æ£€æŸ¥ï¼Œä»¥ç¡®å®šåœ¨å¾ªç¯çš„æ¯æ¬¡è¿­ä»£ä¸­ç´¢å¼•æ˜¯å¦åœ¨æ•°ç»„çš„è¾¹ç•Œå†…ã€‚

ä½œä¸ºæ›´ç®€æ´çš„æ›¿ä»£æ–¹æ¡ˆï¼Œå¯ä»¥ä½¿ç”¨ `for` å¾ªç¯æ¥å¯¹ä¸€ä¸ªé›†åˆçš„æ¯ä¸ªå…ƒç´ æ‰§è¡Œä¸€äº›ä»£ç ã€‚`for` å¾ªç¯çœ‹èµ·æ¥å¦‚ç¤ºä¾‹ 3-5 æ‰€ç¤ºï¼š

```rust linenums="1" title="src/main.rs"
fn main() {
    let a = [10, 20, 30, 40, 50];

    for element in a {
        println!("the value is: {}", element);
    }
}
```

å½“è¿è¡Œè¿™æ®µä»£ç æ—¶ï¼Œå°†çœ‹åˆ°ä¸ç¤ºä¾‹ 3-4 ä¸€æ ·çš„è¾“å‡ºã€‚æ›´ä¸ºé‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬å¢å¼ºäº†ä»£ç å®‰å…¨æ€§ï¼Œå¹¶æ¶ˆé™¤äº†å¯èƒ½ç”±äºè¶…å‡ºæ•°ç»„çš„ç»“å°¾æˆ–éå†é•¿åº¦ä¸å¤Ÿè€Œç¼ºå°‘ä¸€äº›å…ƒç´ è€Œå¯¼è‡´çš„ bugã€‚

ä½¿ç”¨ `for` å¾ªç¯çš„è¯ï¼Œå°±ä¸éœ€è¦æƒ¦è®°ç€åœ¨æ”¹å˜æ•°ç»„å…ƒç´ ä¸ªæ•°æ—¶ä¿®æ”¹å…¶ä»–çš„ä»£ç äº†ï¼Œå°±åƒä½¿ç”¨ç¤ºä¾‹ 3-4 ä¸­ä½¿ç”¨çš„æ–¹æ³•ä¸€æ ·ã€‚

`for` å¾ªç¯çš„å®‰å…¨æ€§å’Œç®€æ´æ€§ä½¿å¾—å®ƒæˆä¸º Rust ä¸­ä½¿ç”¨æœ€å¤šçš„å¾ªç¯ç»“æ„ã€‚å³ä½¿æ˜¯åœ¨æƒ³è¦å¾ªç¯æ‰§è¡Œä»£ç ç‰¹å®šæ¬¡æ•°æ—¶ï¼Œä¾‹å¦‚ç¤ºä¾‹ 3-3 ä¸­ä½¿ç”¨ `while` å¾ªç¯çš„å€’è®¡æ—¶ä¾‹å­ï¼Œå¤§éƒ¨åˆ† Rustacean ä¹Ÿä¼šä½¿ç”¨ `for` å¾ªç¯ã€‚è¿™ä¹ˆåšçš„æ–¹å¼æ˜¯ä½¿ç”¨ `Range`ï¼Œå®ƒæ˜¯æ ‡å‡†åº“æä¾›çš„ç±»å‹ï¼Œç”¨æ¥ç”Ÿæˆä»ä¸€ä¸ªæ•°å­—å¼€å§‹åˆ°å¦ä¸€ä¸ªæ•°å­—ä¹‹å‰ç»“æŸçš„æ‰€æœ‰æ•°å­—çš„åºåˆ—ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ `for` å¾ªç¯æ¥å€’è®¡æ—¶çš„ä¾‹å­ï¼Œå®ƒè¿˜ä½¿ç”¨äº†ä¸€ä¸ªæˆ‘ä»¬è¿˜æœªè®²åˆ°çš„æ–¹æ³•ï¼Œ`rev`ï¼Œç”¨æ¥åè½¬åŒºé—´ï¼ˆrangeï¼‰:


```rust linenums="1" title="src/main.rs"
fn main() {
    for number in (1..4).rev() {
        println!("{}!", number);
    }
    println!("LIFTOFF!!!");
}
```

è¿™æ®µä»£ç æ›´å¥½ä¸€äº›ï¼Œä¸æ˜¯å—ï¼Ÿ

## 6. æ€»ç»“

ä½ åšåˆ°äº†ï¼è¿™æ˜¯ä¸€ä¸ªå¤§ç« èŠ‚ï¼šä½ å­¦ä¹ äº†å˜é‡ã€æ ‡é‡å’Œå¤åˆæ•°æ®ç±»å‹ã€å‡½æ•°ã€æ³¨é‡Šã€`if` è¡¨è¾¾å¼å’Œå¾ªç¯ï¼è¦ç»ƒä¹ æœ¬ç« è®¨è®ºçš„æ¦‚å¿µï¼Œè¯·å°è¯•ç¼–å†™ç¨‹åºæ¥å®ç°ä»¥ä¸‹æ“ä½œï¼š

- åœ¨åæ°æ¸©åº¦å’Œæ‘„æ°åº¦ä¹‹é—´è½¬æ¢æ¸©åº¦ã€‚
- ç”Ÿæˆ n é˜¶æ–æ³¢é‚£å¥‘æ•°åˆ—ã€‚
- æ‰“å°åœ£è¯é¢‚æ­Œ â€œThe Twelve Days of Christmasâ€ çš„æ­Œè¯ï¼Œåˆ©ç”¨æ­Œæ›²ä¸­çš„é‡å¤éƒ¨åˆ†ï¼ˆç¼–å†™å¾ªç¯ï¼‰ã€‚

å½“ä½ å‡†å¤‡å¥½ç»§ç»­å‰è¿›æ—¶ï¼Œæˆ‘ä»¬å°†è®¨è®ºä¸€ä¸ªå…¶ä»–è¯­è¨€ä¸­ **å¹¶ä¸** å¸¸è§çš„æ¦‚å¿µï¼šæ‰€æœ‰æƒï¼ˆownershipï¼‰ã€‚

